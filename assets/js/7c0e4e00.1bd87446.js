"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[880],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>f});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),s=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=s(e.components);return r.createElement(c.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=s(t),g=o,f=u["".concat(c,".").concat(g)]||u[g]||m[g]||a;return t?r.createElement(f,l(l({ref:n},p),{},{components:t})):r.createElement(f,l({ref:n},p))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,l=new Array(a);l[0]=g;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i[u]="string"==typeof e?e:o,l[1]=i;for(var s=2;s<a;s++)l[s]=t[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"},120:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>s});var r=t(7462),o=(t(7294),t(3905));const a={sidebar_position:2},l="package client",i={unversionedId:"putting-it-all-together/package-client",id:"putting-it-all-together/package-client",title:"package client",description:"client.go",source:"@site/docs/putting-it-all-together/package-client.md",sourceDirName:"putting-it-all-together",slug:"/putting-it-all-together/package-client",permalink:"/crd-controller-from-scratch/docs/putting-it-all-together/package-client",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"package api",permalink:"/crd-controller-from-scratch/docs/putting-it-all-together/package-api"},next:{title:"informer.go",permalink:"/crd-controller-from-scratch/docs/putting-it-all-together/informer-go"}},c={},s=[{value:"client.go",id:"clientgo",level:2}],p={toc:s},u="wrapper";function m(e){let{components:n,...t}=e;return(0,o.kt)(u,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"package-client"},"package client"),(0,o.kt)("h2",{id:"clientgo"},"client.go"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-client"},'package client\n\nimport (\n    "context"\n    "github.com/caozhuozi/balloon-controller/api"\n    metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"\n    "k8s.io/apimachinery/pkg/watch"\n    "k8s.io/client-go/kubernetes/scheme"\n    "k8s.io/client-go/rest"\n)\n\ntype BalloonClient struct {\n    restClient rest.Interface\n    ns         string\n}\n\nfunc setConfigDefaults(config *rest.Config) error {\n    // \ud83e\udd16\ufe0f (1)\n    gv := api.GroupVersion\n    config.GroupVersion = &gv\n    config.APIPath = "/apis"\n    // \ud83e\udd16\ufe0f (2)\n    config.NegotiatedSerializer = scheme.Codecs.WithoutConversion()\n\n    return nil\n\n}\n\nfunc NewBalloonClient(c *rest.Config, namespace string) (*BalloonClient, error) {\n    config := *c\n    if err := setConfigDefaults(&config); err != nil {\n        return nil, err\n    }\n    // \ud83e\udd16\ufe0f (1)\n    client, err := rest.RESTClientFor(&config)\n    if err != nil {\n        return nil, err\n    }\n    return &BalloonClient{restClient: client, ns: namespace}, nil\n}\n\n// \ud83e\udd16\ufe0f (1)\nfunc (c *BalloonClient) Get(ctx context.Context, name string, opts metav1.GetOptions) (*api.Balloon, error) {\n    result := api.Balloon{}\n    err := c.restClient.\n        Get().\n        Namespace(c.ns).\n        Resource("balloons").\n        Name(name).\n        VersionedParams(&opts, scheme.ParameterCodec).\n        Do(ctx).\n        Into(&result)\n\n    return &result, err\n}\n// \ud83e\udd16\ufe0f (1)\nfunc (c *BalloonClient) List(ctx context.Context, opts metav1.ListOptions) (*api.BalloonList, error) {\n    result := api.BalloonList{}\n    err := c.restClient.\n        Get().\n        Namespace(c.ns).\n        Resource("balloons").\n        VersionedParams(&opts, scheme.ParameterCodec).\n        Do(ctx).\n        Into(&result)\n\n    return &result, err\n}\n\n// \ud83e\udd16\ufe0f (1)\nfunc (c *BalloonClient) Create(ctx context.Context, balloon *api.Balloon) (*api.Balloon, error) {\n    result := &api.Balloon{}\n    err := c.restClient.\n        Post().\n        Namespace(c.ns).\n        Resource("balloons").\n        Body(balloon).\n        Do(ctx).\n        Into(result)\n\n    return result, err\n}\n\n// \ud83e\udd16\ufe0f (1) (2)\nfunc (c *BalloonClient) Watch(ctx context.Context, opts metav1.ListOptions) (watch.Interface, error) {\n    opts.Watch = true\n    return c.restClient.\n        Get().\n        Namespace(c.ns).\n        Resource("balloons").\n        VersionedParams(&opts, scheme.ParameterCodec).\n        Watch(ctx)\n}\n\n// \ud83e\udd16\ufe0f (1) (3)\nfunc (c *BalloonClient) UpdateStatus(ctx context.Context, balloon *api.Balloon, opts metav1.UpdateOptions) (result *api.Balloon, err error) {\n    result = &api.Balloon{}\n    err = c.restClient.Put().\n        Namespace(c.ns).\n        Resource("balloons").\n        Name(balloon.Name).\n        SubResource("status").\n        VersionedParams(&opts, scheme.ParameterCodec).\n        Body(balloon).\n        Do(ctx).\n        Into(result)\n    return result, err\n}\n')),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"../client-go/restclient#restclient%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"},"RESTClient\u57fa\u672c\u7528\u6cd5")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"../client-go/controller#%E8%A2%AB%E9%81%97%E5%BF%98%E7%9A%84%E7%9B%91%E5%90%ACwatch%E6%9C%BA%E5%88%B6"},"watch\u673a\u5236")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"../client-go/controller#kubernetes%E5%AF%B9%E8%B1%A1%E5%AD%90%E8%B5%84%E6%BA%90status"},"status\u5b50\u8d44\u6e90"))))}m.isMDXComponent=!0}}]);