<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-apimachinery/kubernetes-api">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">从Kubernetes API谈起 | 《从零实现Kubernetes自定义控制器》</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://caozhuozi.github.io/crd-controller-from-scratch/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://caozhuozi.github.io/crd-controller-from-scratch/img/logo.png"><meta data-rh="true" property="og:url" content="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/kubernetes-api"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="从Kubernetes API谈起 | 《从零实现Kubernetes自定义控制器》"><meta data-rh="true" name="description" content="在正式深入apimachinery源码之前，我们首先需要介绍与Kubernetes API相关的一些重要术语，这是我们理解apimachinery库的前提。"><meta data-rh="true" property="og:description" content="在正式深入apimachinery源码之前，我们首先需要介绍与Kubernetes API相关的一些重要术语，这是我们理解apimachinery库的前提。"><link data-rh="true" rel="icon" href="/crd-controller-from-scratch/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/kubernetes-api"><link data-rh="true" rel="alternate" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/kubernetes-api" hreflang="en"><link data-rh="true" rel="alternate" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/kubernetes-api" hreflang="x-default"><link rel="stylesheet" href="/crd-controller-from-scratch/assets/css/styles.37df9119.css">
<link rel="preload" href="/crd-controller-from-scratch/assets/js/runtime~main.56e28771.js" as="script">
<link rel="preload" href="/crd-controller-from-scratch/assets/js/main.66bc2718.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#e6f6e6;color:#5f805b" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">🥳v0.6.0-rc2 is released.🎉</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/crd-controller-from-scratch/"><div class="navbar__logo"><img src="/crd-controller-from-scratch/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/crd-controller-from-scratch/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/crd-controller-from-scratch/docs/intro">开始</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/caozhuozi/crd-controller-from-scratch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/crd-controller-from-scratch/docs/intro">前言</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/crd-controller-from-scratch/docs/apimachinery/apimachinery">apimachinery</a><button aria-label="Toggle the collapsible sidebar category &#x27;apimachinery&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/kubernetes-api">从Kubernetes API谈起</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/gvk">GVK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/runtime.Object">runtime.Object</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/kind-case-study">kind案例探究</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/serializer">序列化器与序列化器工厂</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/client-go-and-apimachinery">client-go与apimachinery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/summary">本章小结</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/crd-controller-from-scratch/docs/client-go/client-go">client-go</a><button aria-label="Toggle the collapsible sidebar category &#x27;client-go&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/crd-controller-from-scratch/docs/putting-it-all-together/putting-it-all-together">putting it all together</a><button aria-label="Toggle the collapsible sidebar category &#x27;putting it all together&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/crd-controller-from-scratch/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/crd-controller-from-scratch/docs/apimachinery/apimachinery"><span itemprop="name">apimachinery</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">从Kubernetes API谈起</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>从Kubernetes API谈起</h1><p>在正式深入<code>apimachinery</code>源码之前，我们首先需要介绍与<em>Kubernetes API</em>相关的一些重要术语，这是我们理解<code>apimachinery</code>库的前提。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>这些术语是本书论述的基础，它们与理解自定义控制器的实现以及Kubernetes二次开发直接相关。
同时这些专有名词在概念上非常相似，也请你尽量保持耐心。</p></div></div><p>我们所说的<em>Kubernetes API</em>是指Kubernetes组件<a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/" target="_blank" rel="noopener noreferrer"><code>kube-apiserver</code></a>(Kubernetes API server)暴露的HTTP API。
Kubernetes API大体上<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>是基于<em>资源（Resource）</em><sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>的<em>RESTful</em><sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup>风格的编程接口，它支持通过标准HTTP动词（POST、PUT、PATCH、DELETE、GET）来检索、创建、更新和删除集群<em>资源</em>。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>根据文档<a href="https://github.com/kubernetes/design-proposals-archive/blob/main/architecture/declarative-application-management.md#configuration-using-rest-api-resource-specifications" target="_blank" rel="noopener noreferrer">Declarative application management in Kubernetes <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>，Kubernetes API Server被设计成系统<strong>唯一</strong>的对外交互接口。
不管是客户端工具（<code>kubectl</code>），UI(<code>dashboard</code>)，还是Kubernetes系统内部其他组件（<code>kubelet</code>，内置的<em>控制器（Controller）</em><sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup>等）在背后，它们最终仍然指向Kubernetes API。</p><p>你可以在Kubernetes API的<a href="https://github.com/kubernetes/kubernetes/blob/release-1.27/api/openapi-spec/swagger.json" target="_blank" rel="noopener noreferrer">OpenAPI specification文件 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>中找到所有API的schema。
另外，<a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.27/" target="_blank" rel="noopener noreferrer">Kubernetes API reference <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a>以文档的形式记录所有了所有API接口的详细说明。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes资源">Kubernetes资源<a href="#kubernetes资源" class="hash-link" aria-label="Direct link to Kubernetes资源" title="Direct link to Kubernetes资源">​</a></h2><p>我们介绍的第一个API术语是<em>Kubernetes资源（Resource）</em>。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http与resource">HTTP与Resource<a href="#http与resource" class="hash-link" aria-label="Direct link to HTTP与Resource" title="Direct link to HTTP与Resource">​</a></h3><p>在介绍<em>Kubernetes资源</em>之前，我想首先引入一个与它极为相似的概念——HTTP（或是Web）语境下的<em>资源</em>，私以为这有助于我们理解<em>Kubernetes资源</em>。</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>HTTP语境下Resource的定义</summary><div><div class="collapsibleContent_i85q"><p>HTTP语境下的<em>Resource</em>的概念首次在<a href="/crd-controller-from-scratch/docs/apimachinery/rfc1630">RFC 1630</a>中伴随URI(Uniform Resource Identifier)的概念而引入，关于它的明确说明直到<a href="/crd-controller-from-scratch/docs/apimachinery/rfc3986">RFC 3986</a>中才正式出现，不过仍然以<em>URI</em>的角度阐述：</p><blockquote><p><a href="https://datatracker.ietf.org/doc/html/rfc3986#section-1.1" target="_blank" rel="noopener noreferrer">Resource</a></p><p>This specification does not limit the scope of what might be a resource;
rather, the term &quot;resource&quot; is used in a general sense for whatever might be identified by a URI.</p></blockquote><p>意思是说，术语<em>Resource</em>可以是URI所指代的任何内容；</p><p>在<a href="/crd-controller-from-scratch/docs/apimachinery/rfc3986">RFC 3986</a>之前，RESTful风格的提出者Roy T. Fielding在其关于REST的<a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="_blank" rel="noopener noreferrer">学位论文</a>也给出了<em>Resource</em>的定义：</p><blockquote><p><a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_2_1_1" target="_blank" rel="noopener noreferrer">5.2.1.1 Resources and Resource Identifiers</a></p><p>The key abstraction of information in REST is a resource.
Any information that can be named can be a resource: a document or image, a temporal service (e.g. &quot;today&#x27;s weather in Los Angeles&quot;), a collection of other resources, a non-virtual object (e.g. a person), and so on.</p></blockquote><p>意思是说，REST风格中的<em>Resource</em>是指可以被命名的任何信息：它可以是一个文档，一张图片，（甚至可以是）洛杉矶的当日温度等等；</p></div></div></details><p>总体上来说，不管是<a href="https://www.ietf.org/standards/rfcs/" target="_blank" rel="noopener noreferrer">RFCs</a>还是<a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="_blank" rel="noopener noreferrer">REST的论文</a>中关于<em>Resource</em>的说明或者定义是<strong>抽象</strong>的。
不过，基于上述略显晦涩的说明，网络或者书籍中上也有对HTTP<em>资源</em>更为通俗的解释。例如：<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Identifying_resources_on_the_Web" target="_blank" rel="noopener noreferrer">MDN Web Docs</a>对<em>资源</em>给出的解释：</p><blockquote><p>The target of an HTTP request is called a &quot;resource&quot;, whose nature isn&#x27;t defined further; it can be a document, a photo, or anything else.</p></blockquote><p>也就是：<strong>HTTP请求的&quot;目标&quot;即为<em>资源</em>，它可以是文档、图片或者是其他（存储在服务端的）任何&quot;内容&quot;</strong>。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>这些&quot;内容&quot;也可以是数据库中的一行数据，也可以是算法的执行结果等<sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup>。</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="http资源的表现形式">HTTP资源的表现形式<a href="#http资源的表现形式" class="hash-link" aria-label="Direct link to HTTP资源的表现形式" title="Direct link to HTTP资源的表现形式">​</a></h4><p>尽管<a href="/crd-controller-from-scratch/docs/apimachinery/rfc3986">RFC 3986</a>或者<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Identifying_resources_on_the_Web" target="_blank" rel="noopener noreferrer">MDN Web Docs</a>都强调了<em>资源</em>没有任何形式上的限制，但通常，HTTP<em>资源</em>应当可以被表示成比特流（字节序列）<sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup>。
服务端可以为资源提供不同的表现格式，例如，使用JSON或者XML（编码后以在网络中以字节流的形式传输）<sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup>。 客户端也可以使用HTTP<a href="https://datatracker.ietf.org/doc/html/rfc2295" target="_blank" rel="noopener noreferrer"><em>内容协商</em></a>来与服务端协商资源的具体表现形式。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="从http资源到kubernetes资源初识kubernetes资源">从HTTP资源到Kubernetes资源——初识Kubernetes资源<a href="#从http资源到kubernetes资源初识kubernetes资源" class="hash-link" aria-label="Direct link to 从HTTP资源到Kubernetes资源——初识Kubernetes资源" title="Direct link to 从HTTP资源到Kubernetes资源——初识Kubernetes资源">​</a></h3><p>在了解了HTTP语境下的资源之后，我们再来认识<em>Kubernetes资源</em>。</p><p>在文档<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>中，我们可以找到官方社区对<em>Kubernetes资源</em>的一种描述：</p><blockquote><p><strong>Resource</strong> a representation of a system entity, sent or retrieved as JSON via HTTP to the server.</p></blockquote><p>意思是说：<em>Kubernetes资源</em>代表了集群中的一个&quot;存在物&quot;<sup id="fnref-6"><a href="#fn-6" class="footnote-ref">6</a></sup>，通过HTTP，它以JSON的形式在客户端与Kubernetes API Server间传输。</p><p>这个描述其实与<em>HTTP资源</em>的概念极为相似。
只不过对于Kubernetes集群来说，在API URI的另一侧并不是Web语境下的文档，图片等，而是集群中的一个&quot;存在物&quot;——常见的<code>pods</code>，<code>deployments</code>，<code>services</code>等都是<em>Kubernetes资源</em>，它们也都有对应的JSON格式在网络中传输。</p><p>当然，文档<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>对<em>Kubernetes资源</em>的描述还是稍显模糊。
我们能否像<a href="https://www.ietf.org/standards/rfcs/" target="_blank" rel="noopener noreferrer">RFCs</a>的风格一般对<em>Kubernetes资源</em>这个术语作出严格的定义呢？
幸运的是，在<a href="https://kubernetes.io/docs/reference/using-api/api-concepts/" target="_blank" rel="noopener noreferrer">Kubernetes API Concepts <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a>文档中，官方其实对Kubernetes API相关术语也有更为严谨的描述：</p><blockquote><p><a href="https://kubernetes.io/docs/reference/using-api/api-concepts/#standard-api-terminology" target="_blank" rel="noopener noreferrer">Kubernetes API terminology</a></p><p>Kubernetes generally leverages common RESTful terminology to describe the API concepts:</p><ul><li>A resource type is the name used in the URL</li><li>All resource types have a concrete representation (their object schema) which is called a kind</li><li>A single instance of a resource type is called a resource, and also usually represents an object</li></ul></blockquote><p>事情似乎看起来并不简单，为了定义<em>Kubernetes资源</em>，官方还引入了<em>resource type</em>和<em>kind</em>的概念。
本节接下来的内容，便是对上述定义的详细解读。请跟随我一起开始了解这些术语吧。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="api分组group和版本化version">API分组（group）和版本化（version）<a href="#api分组group和版本化version" class="hash-link" aria-label="Direct link to API分组（group）和版本化（version）" title="Direct link to API分组（group）和版本化（version）">​</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>为了解释清楚<em>resource type</em>、<em>kind</em>、以及<em>resource</em>这三个术语，我们需要从Kubernetes API URL的结构说起。</p></div></div><p>为了便于扩展和迭代API，Kubernetes对所有API进行分组(API groups)和版本化(version)<sup id="fnref-7"><a href="#fn-7" class="footnote-ref">7</a></sup>。
具体来说，所有Kubernetes API路径都会带上分组和版本信息，它们通常符合形式<code>apis/{group}/{version}/...</code>并以此形式作为API的根路径。</p><p>例如：API<code>/apis/batch/v1/...</code> 的分组是<code>batch</code>，版本是<code>v1</code>；</p><p>需要注意的是，API分组的名称并不局限于一个单词，一个常见到的命名模式是（伪）子域名<sup id="fnref-8"><a href="#fn-8" class="footnote-ref">8</a></sup>风格，例如：
API<code>/apis/networking.k8s.io/v1alpha1</code>的分组是<code>networking.k8s.io</code>，版本是<code>v1alpha1</code>。
特别是通过CRD扩展Kubernetes API时，使用组织的伪子域名作为API分组名称似乎已经成为一种约定，例如：
<a href="https://istio.io/" target="_blank" rel="noopener noreferrer">istio</a>组织使用<code>networking.istio.io</code>作为分组名来扩展Kubernetes API。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>API分组的历史</div><div class="admonitionContent_S0QG"><p>我们在这里有必要提及一下Kubernetes API引入<em>分组</em>的历史。</p><p>在<a href="https://github.com/kubernetes/kubernetes/tree/v1.1.0" target="_blank" rel="noopener noreferrer">Kubernetes v1.1.0</a>以前，Kubernetes API只有版本的概念，每个版本对应不同的API路径前缀，例如<code>api/v1/</code>，<code>/api/v1beta3</code>等。
在<a href="https://github.com/kubernetes/kubernetes/tree/v1.1.0-beta" target="_blank" rel="noopener noreferrer">Kubernetes v1.1.0-beta</a>，官方开发者正式发起API分组的提案：<a href="https://github.com/kubernetes/kubernetes/pull/12951" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #12951</a>。
在该提案中，官方开发者认为API引入分组的目的和相应的好处有：</p><blockquote><ol><li>Breaking the monolithic v1 API into modular groups and allowing groups to be enabled/disabled individually. This allows us to break the monolithic API server to smaller components in the future.</li><li>Supporting different versions in different groups. This allows different groups to evolve at different speed.</li></ol></blockquote><p>意思是说：</p><blockquote><ol><li>将单个&quot;整块&quot;的v1 API分组模块化，并且允许单独启用/禁用某个分组。这使我们能够将API服务端分解为更小的组件。</li><li>在同一个分组中可以有不同的版本。这使得不同的分组间可以以不同的速度并行迭代。</li></ol></blockquote><p>在操作细节上，作者提出：</p><ul><li>对于已有的API，为了向前兼容，它们的API路径维持不变；</li><li>对于未来可能出现的新API分组，根路径需要为<code>apis/</code>而非原先的<code>api/</code>，同时将组名及版本信息依次置于<code>apis/</code>后，即<code>apis/{group}/{version}/</code>。</li></ul><p>因此，<strong>并不是所有的Kubernetes API都带有分组信息</strong>。例如：在分组之前就存在的API<code>api/v1/namespaces/default/pods</code>仍然维持不变。</p><p>对于新的分组，在<a href="https://github.com/kubernetes/kubernetes/tree/v1.2.0-alpha.2" target="_blank" rel="noopener noreferrer">Kubernetes v1.2.0-alpha.2</a>正式迎来了第一个新的API分组<code>extensions</code>，它的API REST路径是<code>apis/extensions/</code>。
像后来大家熟知的<code>deployments</code>，<code>daemonsets</code>，<code>jobs</code>等资源类型最开始都被放置在这个实验性质的分组中&quot;孵化&quot;。
在<a href="https://github.com/kubernetes/kubernetes/tree/v1.2.0-beta.0" target="_blank" rel="noopener noreferrer">Kubernetes v1.2.0-beta.0</a>，<code>jobs</code>从<code>extensions</code>分组正式迁移到<code>batch</code>分组：<a href="https://github.com/kubernetes/kubernetes/pull/21434" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #21434</a>；
在<a href="https://github.com/kubernetes/kubernetes/tree/v1.6.0-beta.1" target="_blank" rel="noopener noreferrer">Kubernetes v1.6.0-beta.1</a>，<code>deployments</code>从<code>extensions</code>分组正式迁移到<code>apps</code>分组：<a href="https://github.com/kubernetes/kubernetes/pull/39683" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #39683</a>。</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>API版本的历史</div><div class="admonitionContent_S0QG"><p>对于Kubernetes API版本的历史，可以说自Kubernetes源码公开以来<code>kube-apiserver</code>的API就已经带有版本信息。
根据（公开的）Kubernetes源码的第一个提交<code>2c4b3a5</code>：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">cmd/apiserver/apiserver.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> apiPrefix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;api_prefix&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/api/v1beta1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;The prefix for API requests on the server. Default &#x27;/api/v1beta1&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以看出公开的Kubernetes源码中已知的第一个API版本为<code>/api/v1beta1</code>。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="资源类型resource-type">资源类型（resource type）<a href="#资源类型resource-type" class="hash-link" aria-label="Direct link to 资源类型（resource type）" title="Direct link to 资源类型（resource type）">​</a></h2><p>Kubernetes API URI<sup id="fnref-9"><a href="#fn-9" class="footnote-ref">9</a></sup>按照是否含有命名空间（namespace）<sup id="fnref-10"><a href="#fn-10" class="footnote-ref">10</a></sup>的信息又可以分为两类：</p><ul><li><code>/apis/{group}/{version}/...</code></li><li><code>/apis/{group}/{version}/namespaces/{namespace}/...</code></li></ul><p>在上述两类的URL模式中，紧跟其后的路径片段被称为<em>资源类型（resource type）</em>。
即，</p><ul><li><code>/apis/{group}/{version}/{resource type}/...</code></li><li><code>/apis/{group}/{version}/namespaces/{namespace}/{resource type}</code>。</li></ul><p>例如：</p><ul><li>API<code>/apis/authorization.k8s.io/v1/subjectaccessreviews</code>对应的资源类型是<code>subjectaccessreviews</code>;</li><li>API<code>/api/batch/v1/namespaces/default/jobs</code>对应的资源类型是<code>jobs</code>;</li></ul><p>另外，资源类型作为API URI中的一个标识，它们是小写的且为复数形式的。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>上述的定义来自于:</p><blockquote><p><a href="https://kubernetes.io/docs/reference/using-api/api-concepts/#standard-api-terminology" target="_blank" rel="noopener noreferrer">Kubernetes API terminology</a></p><p> A resource type is the name used in the URL</p></blockquote><p>官方的描述其实还是略显模糊，因为此描述并没有解释<em>name</em>又是什么。但是至少透露出一个信息：<strong><em>resource type</em>是基于Kubernetes API URL的一个概念</strong>。
因此我们根据官方想要表达的意思，基于Kubernetes API URI的规则，给出了我们对<em>resource type</em>的定义。</p><p>需要在这里提醒的是，依据官方的描述，<em>资源类型</em>是Kubernetes API URI中一个特定位置的标识——我们其实已经<strong>在没有引入<em>资源</em>的前提下定义了<em>资源类型</em></strong>。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="初识kind">初识<sup id="fnref-11"><a href="#fn-11" class="footnote-ref">11</a></sup>kind<a href="#初识kind" class="hash-link" aria-label="Direct link to 初识kind" title="Direct link to 初识kind">​</a></h2><p>我们现在已经知道<em>资源类型</em>是Kubernetes API URI中特定位置中使用的一个标识（identifier）。
在Kubernetes源码中，每种<em>资源类型</em>在<strong>Go语言</strong>中都对应一个具体的类型（Golang type），这些类型被统称为<em>kind</em>。例如，资源类型<code>cronjobs</code>对应的Go类型是<code>Cronjob</code>：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/api/batch/v1/types.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> CronJob </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TypeMeta </span><span class="token string" style="color:#e3116c">`json:&quot;,inline&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ObjectMeta </span><span class="token string" style="color:#e3116c">`json:&quot;metadata,omitempty&quot; protobuf:&quot;bytes,1,opt,name=metadata&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Spec CronJobSpec </span><span class="token string" style="color:#e3116c">`json:&quot;spec,omitempty&quot; protobuf:&quot;bytes,2,opt,name=spec&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status CronJobStatus </span><span class="token string" style="color:#e3116c">`json:&quot;status,omitempty&quot; protobuf:&quot;bytes,3,opt,name=status&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>与其他语言一样，Go语言也有命名约定（name conventions）。对于类型（type），Go中的<a href="https://go.dev/doc/effective_go#mixed-caps" target="_blank" rel="noopener noreferrer">约定</a>是使用 lower camel case（小驼峰式）或者upper camel case（大驼峰式）来命名多词名称。
同时，如果一个类型需要在包外可见，它的第一个字母应该是大写的。Kubernetes源码遵循这种命名约定，<em>kind</em>作为Go类型，类型名称自然符合驼峰形式。 此外，相比于<em>资源类型</em>是复数，kind名称则是单数形式。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>所有Kubernetes原生的<em>kind</em>被定义在<code>k8s.io/api</code>库中。另外，不同于分组和版本在URL上以路径片段存在的形式，在<code>k8s.io/api</code>库中，每个分组和版本都对应一个目录（包）：</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>api库目录结构</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">|-- admission</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- admissionregistration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- apidiscovery</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v2beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- apiserverinternal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- apps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- authorization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- autoscaling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v2beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v2beta2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- batch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- certificates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- coordination</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- discovery</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- extensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- flowcontrol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1beta2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- imagepolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- networking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- rbac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1alpha2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- scheduling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-- storage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   |-- v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   `-- v1beta1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p><em>kind</em>被定义在不同的目录中以作区分。</p><p>分组和版本除了在包结构上的体现以外，它们也被记录在每个<em>kind</em>的<code>apiVersion</code>字段中，例如：<code>Job</code>的<code>apiVersion</code>字段为<code>batch/v1</code>；<code>Deployment</code>的<code>apiVersion</code>字段为<code>apps/v1</code>。</p><p>至于为什么用一个版本字段同时记录分组以及版本信息的原因最早可以追溯到引入API分组的提案：<a href="https://github.com/kubernetes/kubernetes/pull/12951" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #12951</a>。
其实在没有API分组以前，<em>kind</em>的<code>apiVersion</code>字段仅用于记录API版本信息。例如<code>v1</code>。
在提案中，作者为了加快开发进度<sup id="fnref-12"><a href="#fn-12" class="footnote-ref">12</a></sup>决定不新增字段而是继续使用<code>apiVersion</code>字段，只是以<code>{version}/{group}</code>字符串拼接的方式把分组和版本信息一并放入<code>apiVersion</code>字段。
同时，对于已经存在的<em>kind</em>，例如<code>Pod</code>，<code>apiVersion</code>字段也还是保留为<code>v1</code>。
在<a href="#https://github.com/kubernetes/kubernetes/tree/v1.2.0-alpha.2">Kubernetes v1.2.0-alpha.2</a>，社区在迎来第一个新的分组<code>extensions</code>的同时，原先就存在的<em>kind</em>也拥有了一个正式的分组名——<code>core</code>（核心）<sup id="fnref-13"><a href="#fn-13" class="footnote-ref">13</a></sup>。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="从kubernetes-kind到kubernetes资源再识kubernetes资源">从Kubernetes kind到Kubernetes资源——再识Kubernetes资源<a href="#从kubernetes-kind到kubernetes资源再识kubernetes资源" class="hash-link" aria-label="Direct link to 从Kubernetes kind到Kubernetes资源——再识Kubernetes资源" title="Direct link to 从Kubernetes kind到Kubernetes资源——再识Kubernetes资源">​</a></h2><p><em>kind</em>作为Kubernetes源码中的Go类型，站在集群运行的角度，Kubernetes组件（<code>kube-apiserver</code>、<code>kubelet</code>等）在运行时可以在内存中创建kind的具体实例（instance），这些实例也可以通过序列化以字节的形式或在网络中传输（JSON格式）或写入磁盘中（etcd）。
简而言之，<em>kind</em>的具体实例被称作<em>资源（resource）</em>。在Kubernetes中，每个<em>资源</em>都有属于自己的一个名字。</p><p>同时，每个资源也独立地对应一个API URI——将资源的名字（作为<em>路径片段</em>）追加在资源类型后即可：
<code>/apis/{group}/{version}/namespaces/{namespace}/{resource type}/{name}</code>。
例如：一个<em>资源类型</em>为<code>jobs</code>且名字为<code>my-job</code>的<em>资源</em>对应的API URI为<code>/api/batch/v1/namespaces/default/jobs/my-job</code>。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>有时，在相关技术文章和博客中，我们甚至也可以见到用资源的API URL指代资源本身的情况。例如：
Kubernetes社区核心贡献者 <a href="https://github.com/liggitt" target="_blank" rel="noopener noreferrer">Jordan Liggitt</a> 在StackOverflow上的一个<a href="https://stackoverflow.com/a/52314551" target="_blank" rel="noopener noreferrer">回答</a>:</p><blockquote><p>A specific URL used to obtain the object is a resource.
For example, a list of v1 Pod objects can be obtained from the <code>/api/v1/pods</code> resource.
A specific v1 Pod object can be obtained from the <code>/api/v1/namespaces/&lt;namespace-name&gt;/pods/&lt;pod-name&gt;</code> resource.</p></blockquote><p>总之，术语<em>Kubernetes资源</em>被广泛用于各种文档和博客中，但是它的实际意义需要根据不同的上下文具体分析得出。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="小结">小结<a href="#小结" class="hash-link" aria-label="Direct link to 小结" title="Direct link to 小结">​</a></h3><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>总结</div><div class="admonitionContent_S0QG"><p>从Kubernetes API的规则到<em>资源类型</em>，从<em>资源类型</em>再到<em>kind</em>的定义，从<em>kind</em>再到<em>资源</em>，
我们按照文档<a href="https://kubernetes.io/docs/reference/using-api/api-concepts/#standard-api-terminology" target="_blank" rel="noopener noreferrer">Kubernetes API terminology <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a>的思路<strong>严格地</strong>定义了这些术语。
经验告诉我们，越是严格的定义往往越是晦涩。</p><p>当然这种严格也相应地带来一些好处——我们可以更为全面地引申Kubernetes<em>资源</em>的所指。
Kubernetes资源既然是<em>kind</em>的实例，那么它们将并不局限于以JSON的形式存在，它们也可以是：YAML格式甚至是（实例序列化后的）字节流（bytes）的形式等。
同时，在Kubernetes系统中，这些数据形式又存在于多种媒介中：内存（<code>kubectl</code>，<code>kube-apiserver</code>，<code>kubelet</code>等）、网络（HTTP）、文件（YAML）、磁盘（etcd）。</p><p>在绝大多数时候，我们对<em>Kubernetes资源</em>的第一种认知已经足够（即便它可能是模糊的）。
我们其实也可以基于<a href="#%E4%BB%8Ehttp%E8%B5%84%E6%BA%90%E5%88%B0kubernetes%E8%B5%84%E6%BA%90%E5%88%9D%E8%AF%86kubernetes%E8%B5%84%E6%BA%90">第一种认知</a>它去理解<em>资源类型</em>以及<em>kind</em>：</p><ul><li><em>资源类型</em>是<em>Kubernetes资源</em>所属种类的名称，它们（以小写和复数的形式）作为API URL中特定位置的一个标识。</li><li><em>kind</em>是<em>Kubernetes资源</em>JSON格式在序列化前/反序列化后对应的Go类型。当然，如果不局限于具体语言，广义上，我们也可以把<em>kind</em>认为是Kubernetes API的JSON Schema<sup id="fnref-14"><a href="#fn-14" class="footnote-ref">14</a></sup>。</li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="其它api术语">其它API术语<a href="#其它api术语" class="hash-link" aria-label="Direct link to 其它API术语" title="Direct link to 其它API术语">​</a></h2><p>到现在，我们已经了解了<em>资源</em>，<em>资源类型</em>，<em>kind</em> 这些API术语。其实还有一些其他术语，它们同样与Kubernetes二次开发息息相关；</p><p>这些术语包括：<em>虚拟资源</em>，<em>Kubernetes对象</em>，以及<em>子资源</em>；</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="初识kubernetes虚拟资源">初识Kubernetes虚拟资源<a href="#初识kubernetes虚拟资源" class="hash-link" aria-label="Direct link to 初识Kubernetes虚拟资源" title="Direct link to 初识Kubernetes虚拟资源">​</a></h2><p>在正式介绍<em>Kubernetes虚拟资源</em>之前，我想先从一个特殊的Kubernetes API说起：</p><p><code>/apis/authorization.k8s.io/v1/selfsubjectaccessreviews</code>。</p><p>这个API可以用来判断我们对某个资源类型是否有相应的权限<sup id="fnref-15"><a href="#fn-15" class="footnote-ref">15</a></sup>。
例如：假如我们想判断自己是否在<code>default</code>命名空间下创建<code>deployments</code>资源类型的权限，我们可以通过如下POST请求：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /apis/authorization.k8s.io/v1/selfsubjectaccessreviews</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;apiVersion&quot;: &quot;authorization.k8s.io/v1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;kind&quot;: &quot;SelfSubjectAccessReview&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;spec&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;resourceAttributes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;group&quot;: &quot;apps&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;resource&quot;: &quot;deployments&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;verb&quot;: &quot;create&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;namespace&quot;: &quot;default&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此API请求的一个返回是：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;apiVersion&quot;: &quot;authorization.k8s.io/v1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;kind&quot;: &quot;SelfSubjectAccessReview&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;metadata&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;creationTimestamp&quot;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;spec&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;resourceAttributes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;group&quot;: &quot;apps&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;resource&quot;: &quot;deployments&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;namespace&quot;: &quot;dev&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;verb&quot;: &quot;create&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;status&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;allowed&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;denied&quot;: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们可以通过返回体中<code>status</code>字段的<code>allowed</code>来判断我们是否含有相应的权限。</p><p>根据我们先前的定义，这个API的分组为<code>authorization.k8s.io</code>版本为<code>v1</code>，资源类型为<code>selfsubjectaccessreviews</code>。
另外，这个资源类型在Kubernetes源码<code>k8s.io/api</code>库中对应的Go类型是<code>SelfSubjectAccessReview</code>：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/authorization/v1/types.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> SelfSubjectAccessReview </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TypeMeta </span><span class="token string" style="color:#e3116c">`json:&quot;,inline&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ObjectMeta </span><span class="token string" style="color:#e3116c">`json:&quot;metadata,omitempty&quot; protobuf:&quot;bytes,1,opt,name=metadata&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Spec SelfSubjectAccessReviewSpec </span><span class="token string" style="color:#e3116c">`json:&quot;spec&quot; protobuf:&quot;bytes,2,opt,name=spec&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status SubjectAccessReviewStatus </span><span class="token string" style="color:#e3116c">`json:&quot;status,omitempty&quot; protobuf:&quot;bytes,3,opt,name=status&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>SelfSubjectAccessReview</code>类型的实例（经过序列化/反序列化）以JSON的形式在客户端与Kubernetes API Server间传输。</p><p>因此，如果根据定义，<code>SelfSubjectAccessReview</code>类型的实例仍然属于Kubernetes资源，只是它相比于我们熟知的资源<code>pod</code>等有所不同——它们并不代表集群中的任何&quot;实体&quot;<sup id="fnref-16"><a href="#fn-16" class="footnote-ref">16</a></sup>。
它们仅作为Kubernetes API Server中某些特殊API与客户端间HTTP通信的&quot;<strong>消息载体</strong>&quot;（payload）。这类Kubernetes资源被称为<em>虚拟资源</em>。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>在这里，我们通过一个例子引入<em>虚拟资源</em>。
在后面的小节中，我们还会用更为严谨的叙述来定义<em>Kubernetes虚拟资源</em>。
就像我们定义<em>资源</em>一样，严谨往往意味着我们需要引入额外的概念来辅助解释它本身。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="从kubernetes-api的声明式配置说起">从Kubernetes API的声明式配置说起<a href="#从kubernetes-api的声明式配置说起" class="hash-link" aria-label="Direct link to 从Kubernetes API的声明式配置说起" title="Direct link to 从Kubernetes API的声明式配置说起">​</a></h3><p>为了定义什么是<em>虚拟资源</em>，我们还需要从Kubernetes API的设计说起。
不过在介绍本小节内容之前，我们要事先了解两个基础概念：<em>命令式系统</em>与<em>声明式系统</em>。</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>命令式系统与声明式系统</summary><div><div class="collapsibleContent_i85q"><ul><li>在<em>命令式系统</em>中，用户知道系统的期望状态，由用户来决定系统达到期望状态的命令序列，并向系统提供命令序列。</li><li>在<em>声明式系统</em>中，用户知道系统的期望状态，用户仅向系统提供期望状态的描述，由系统来确定从当前状态达到期望状态所需要的动作序列。</li></ul><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>一个简单的例子</summary><div><div class="collapsibleContent_i85q">我们以泡一壶茶为例。 在声明式系统中，用户只要提供一个期望状态的描述即可：<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- 请给我一杯40度的绿茶</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>而在命令式系统中，用户则需要向系统达到目标状态的完整的命令序列：</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- 将水烧至100度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 把水倒入茶杯中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 放入一个绿茶包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 等待水温降至40度</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>关于声明式系统和命令式系统完整的介绍以及与Kubernetes的联系可以参考Kubernetes文档特别兴趣小组成员<a href="https://github.com/kubernetes/community/blob/master/sig-docs/README.md#emeritus-leads" target="_blank" rel="noopener noreferrer">Andrew Chen</a>的博文: 。</p></div></div></details><p>根据Kubernetes设计文档<a href="https://github.com/kubernetes/design-proposals-archive/blob/main/architecture/resource-management.md" target="_blank" rel="noopener noreferrer">The Kubernetes Resource Model (KRM) <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>，Kubernetes被设计成一个<strong>声明式资源管理系统</strong>。
而Kubernetes API作为系统唯一的对外交互接口也因此被设计成支持<em>资源的声明式配置（Declarative Configuration）</em>。
所谓<em>资源的声明式配置</em>是指用户向Kubernetes API仅提供资源的期望状态的描述，接下来交由系统控制以使资源达到其期望状态。</p><p>例如，当我们通过Kubernetes API创建一个<code>Deployment</code>资源时，</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST apis/apps/v1/deployments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;apiVersion&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;apps/v1&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kind&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Deployment&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;metadata&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;labels&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;app&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;spec&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;replicas&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;template&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;metadata&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;labels&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;app&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;spec&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;containers&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;image&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;busybox&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;imagePullPolicy&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;IfNotPresent&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;restartPolicy&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Always&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;selector&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;matchLabels&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;app&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中，JSON格式的请求体（<em>资源</em>）可以理解成是一种对集群<em>期望状态</em>的描述。
用户将<code>replicas</code>字段设置为<code>3</code>其实表示用户期望此部署要有3个实例运行在集群中。
Kubernetes则会采取一系列动作来确保集群中始终有3个实例在运行——例如，当某个实例运行的节点发生故障，<code>kubelet</code>则会在另一个节点中创建新的实例以确保资源的当前状态与用户的期望状态保持一致。
显然，Kubernetes系统需要记录资源的期望状态才能在之后不断将资源的当前状态与期望状态&quot;对齐&quot;。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes对象kubernetes-object">Kubernetes对象（Kubernetes Object）<a href="#kubernetes对象kubernetes-object" class="hash-link" aria-label="Direct link to Kubernetes对象（Kubernetes Object）" title="Direct link to Kubernetes对象（Kubernetes Object）">​</a></h3><p>正如在上一小节中所说的那样，Kubernetes需要记录资源的期望状态。
而在Kubernetes中，那些需要持久化（存入<code>etcd</code>）的资源实例（persistent entity）被称为<em>Kubernetes对象（Kubernetes Object）</em>。
同时，<em>Kubernetes对象</em>也可以理解成一种对&quot;资源期望状态的记录（record of intent）&quot;。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>对<em>Kubernetes对象</em>的定义来自于对三个官方文档的整合：</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>官方文档中关于Kubernetes对象的解释</summary><div><div class="collapsibleContent_i85q"><ul><li><p><a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/" target="_blank" rel="noopener noreferrer">Objects In Kubernetes <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a></p><blockquote><p><a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/#kubernetes-objects" target="_blank" rel="noopener noreferrer">Understanding Kubernetes objects</a></p><p>Kubernetes objects are persistent entities in the Kubernetes system. Kubernetes uses these entities to represent the state of your cluster.</p></blockquote></li><li><p><a href="https://kubernetes.io/docs/reference/using-api/api-concepts/" target="_blank" rel="noopener noreferrer">Kubernetes API Concepts <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a></p><blockquote><p><a href="https://kubernetes.io/docs/reference/using-api/api-concepts/#standard-api-terminology" target="_blank" rel="noopener noreferrer">Kubernetes API terminology <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a></p><p>Most Kubernetes API resource types are objects – they represent a concrete instance of a concept on the cluster, like a pod or namespace.</p></blockquote></li><li><p><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a></p><blockquote><p>[Types (Kinds)]<!-- -->(https:  //github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds)</p><p>Objects represent a persistent entity in the system.
Creating an API object is a record of intent - once created, the system will work to ensure that resource exists. All API objects have common metadata.</p></blockquote></li></ul></div></div></details><p>根据定义，<em>Kubernetes对象</em>不仅可以是<code>deployments</code>，<code>daemonsets</code>这样&quot;实打实&quot;的集群<a href="https://kubernetes.io/docs/concepts/workloads/" target="_blank" rel="noopener noreferrer">工作负载（workloads）</a>，
它们也可以是<code>services</code>，<code>configmaps</code>，<code>clusterroles</code>，<code>clusterrolebindings</code>，<code>serviceaccounts</code>——只要它们被Kubernetes存入<code>etcd</code>中。</p><p>另外，通常所说的Kubernetes&quot;实体&quot;就是指<em>Kubernetes对象</em>。</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="spec和status">spec和status<a href="#spec和status" class="hash-link" aria-label="Direct link to spec和status" title="Direct link to spec和status">​</a></h4><p>几乎所有的Kubernetes对象都包含两个字段：<code>spec</code>和<code>status</code><sup id="fnref-17"><a href="#fn-17" class="footnote-ref">17</a></sup>。用户/客户端在创建对象时，<code>spec</code>字段用以描述资源的期望状态；
<code>status</code>字段则用于记录和更新资源的当前状态——这个字段通常是由Kubernetes系统内部组件或者<em>控制器（Controller）</em><sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup>更新；</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>并不是所有的Kubernetes对象都包含这两个字段，例如：<a href="https://kubernetes.io/docs/concepts/configuration/configmap/" target="_blank" rel="noopener noreferrer"><code>configmap</code></a>、<a href="https://kubernetes.io/docs/concepts/configuration/secret/" target="_blank" rel="noopener noreferrer"><code>secret</code></a>，它们并不包含<code>spec</code>和<code>status</code>字段，但它们有一个<code>data</code>字段用于记录要存储的数据；
所以，我们也可以认为并不是所有的<em>Kubernetes对象</em>都必须带有&quot;状态&quot;的属性，它们有的单纯只是需要存储的数据；</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="再识kubernetes虚拟资源">再识Kubernetes虚拟资源<a href="#再识kubernetes虚拟资源" class="hash-link" aria-label="Direct link to 再识Kubernetes虚拟资源" title="Direct link to 再识Kubernetes虚拟资源">​</a></h3><p>基于<em>Kubernetes对象</em>的定义，换言之，Kubernetes中存在部分资源并不需要被存入<code>etcd</code>中。这些资源被成为<em>虚拟资源（virtual resource）</em>。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>对于<em>虚拟资源</em>，即便它们并不具有&quot;状态&quot;的属性，也不需要被存入<code>etcd</code>中，但是它们往往也会包含<code>spec</code>和<code>status</code>字段（例如<code>subjectaccessreview</code>）。
按照社区的说法<sup id="fnref-18"><a href="#fn-18" class="footnote-ref">18</a></sup>，这样做的原因是为了在风格上保持一致；</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小结</div><div class="admonitionContent_S0QG"><p>至此，我们知道<em>Kubernetes资源</em>可以分为两类：<em>Kubernetes对象</em>以及<em>Kubernetes虚拟资源</em>；</p><p>尽管<em>资源</em>包括<em>Kubernetes对象</em>，<em>资源</em>的概念更倾向于在Kubernetes API上下文中使用<sup id="fnref-19"><a href="#fn-19" class="footnote-ref">19</a></sup>，
而<em>Kubernetes对象</em>更被侧重用于对集群期望状态的一种描述。
在不严格区分定义的情况下，<em>资源</em>和<em>Kubernetes对象</em>两个概念往往可以被互换使用。</p></div></div><p>下图总结了<em>Kubernetes资源</em>和<em>Kubernetes对象</em>的区别和联系：</p><img loading="lazy" src="/crd-controller-from-scratch/assets/images/resource-and-object-564e01373ee628599efe561899a36a29.png" width="95%" class="img_ev3q">;<h2 class="anchor anchorWithStickyNavbar_LWe7" id="子资源subresource">子资源（subresource）<a href="#子资源subresource" class="hash-link" aria-label="Direct link to 子资源（subresource）" title="Direct link to 子资源（subresource）">​</a></h2><p>在Kubernetes API中，还存在一类特殊的API。它们的结构为在普通资源对应的URI后继续追加一个路径片段得到的URI，即：
<code>/apis/{group}/{version}/namespaces/{namespace}/{resource type}/{name}/{subresource}</code>，
其中最后追加的标识被称为为<em>子资源</em>。
需要注意的是，<strong>子资源并不对应集群中任何实体或虚拟资源</strong>，它们旨在提供与资源资紧密耦合的某种操作或视角。
例如，</p><ul><li>API <code>/api/v1/namespaces/{namespace}/pods/{name}/log</code>可以检索某个pod的日志；</li><li>API <code>/api/v1/namespaces/{namespace}/pods/{name}/portforward</code>可以将本地的端口转发到某个pod中监听的一个或多个端口上；</li><li>API <code>/api/v1/namespaces/{namespace}/pods/{name}/exec</code>可以远程在某个pod的容器中执行命令；</li><li>API <code>/api/v1/namespace/{namespace}/pods/{name}/status</code> 可以检索或者更新某个pod的当前状态。</li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>除了API URI Path上的特殊性外，这些API的特殊性主要体现在以下两点：</p><ol><li>不符合Kubernetes API RESTful风格，它们中有的（例如<code>exec</code>，<code>portforward</code>）甚至采用了<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#websockets-and-spdy" target="_blank" rel="noopener noreferrer">Websocket协议</a>。</li><li>不符合Kubernetes API<a href="#%E4%BB%8Ekubernetes-api%E7%9A%84%E5%A3%B0%E6%98%8E%E5%BC%8F%E9%85%8D%E7%BD%AE%E8%AF%B4%E8%B5%B7"><em>声明式配置（declarative configuration）</em></a>规范。</li></ol></div></div><p>需要注意的是，在Kubernetes中所有<em>Kubernetes对象</em>都有<code>status</code>子资源用于检索或者更新资源的当前状态。
我们在后续<a href="/crd-controller-from-scratch/docs/client-go/controller">Controller</a>小节中还会再次提及<code>status</code>子资源。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>子资源的历史</div><div class="admonitionContent_S0QG"><p>关于引入子资源的历史最早可以追溯到Kubernetes社区的一个讨论<a href="https://github.com/kubernetes/kubernetes/issues/2726" target="_blank" rel="noopener noreferrer">Issue #2776</a>。
这个讨论涉及到应该如何恰当地更新<em>Kubernetes对象</em>的当前状态。
这个问题本质上是由于在没有引入<em>子资源</em>以前，
客户端/用户对资源的修改以及Kubernetes系统内组件对资源当前状态的更新会存在<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#concurrency-control-and-consistency" target="_blank" rel="noopener noreferrer">并发控制和一致性问题 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>，尤其是当更新频繁的时候，这种并发冲突会愈发地严重。
基于此，开发者认为需要将对资源<code>spec</code>字段的更新与<code>status</code>字段的更新分离。
在这个讨论里，官方开发者们提出了很多想法，他们最后采纳了<em>子资源</em>的提议：在普通资源对应的API URL后追加一个路径片段<code>/status</code>暴露一个资源的&quot;子API&quot;，
这个&quot;子API&quot;的请求体仍然是一个完整的资源，但是这个&quot;子API&quot;仅能用于更新资源的<code>status</code>字段而会忽略掉资源的其他字段（<code>spec</code>）。
最终，<em>子资源</em>的实现<a href="https://github.com/kubernetes/kubernetes/pull/4779" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #4779</a>被合并，并在<a href="https://github.com/kubernetes/kubernetes/tree/v0.13.0" target="_blank" rel="noopener noreferrer">Kubernetes v0.13.0</a>中发布；</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="小结-1">小结<a href="#小结-1" class="hash-link" aria-label="Direct link to 小结" title="Direct link to 小结">​</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小结</div><div class="admonitionContent_S0QG"><p>在本节中，我们给出了很多似乎有些晦涩而又相似的概念，这些概念又好像在描述同一个东西。
但是区分和了解这些API术语是Kubernetes二次开发的基础并且有助于我们理解自定义控制器的诸多细节。</p></div></div><p>总之，本节的各个术语确实容易混淆，为了方便读者区分这些概念，本节的内容可以被总结成下图。</p><img loading="lazy" src="/crd-controller-from-scratch/assets/images/resource-object-kind-43fa489bdc023d8b79b2ff5e6cb01934.png" width="95%" class="img_ev3q"><img loading="lazy" src="/crd-controller-from-scratch/assets/images/virtual-resource-b132d137b70664e88507c5e7249b87c2.png" width="95%" class="img_ev3q"><div class="footnotes"><hr><ol><li id="fn-1"><p>并不是所有的Kubernetes API都严格基于<em>RESTful</em>风格。Kubernetes API Server部分API基于HTTP增强协议<a href="https://datatracker.ietf.org/doc/html/rfc6455" target="_blank" rel="noopener noreferrer">WebSocket</a>和<a href="https://www.chromium.org/spdy/spdy-whitepaper/" target="_blank" rel="noopener noreferrer">SPDY</a>。
例如，当你使用<code>kubectl exec</code>命令时，<code>kubectl</code>与<code>kube-apiserver</code>之间基于WebSocket协议，<code>kube-apiserver</code>与<code>kubelet</code>间的通信基于SPDY协议。<a href="#fnref-1" class="footnote-backref">↩</a></p></li><li id="fn-2"><p><em>Kubernetes资源</em>在各类文章和博客中被广泛使用，但大多数时候对这个专有名词的使用并不准确。本节的一个使命就是基于Kubernetes文档就对这些广泛使用的术语给出精确的表述。<a href="#fnref-2" class="footnote-backref">↩</a></p></li><li id="fn-3"><p>关于什么是<em>RESTful</em>请参考提出者Roy T. Fielding的<a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="_blank" rel="noopener noreferrer">学位论文</a>。<a href="#fnref-3" class="footnote-backref">↩</a></p></li><li id="fn-4"><p><em>控制器（Controller）</em>的概念我们会在后续<a href="/crd-controller-from-scratch/docs/client-go/controller">controller</a>章节详细介绍它。<a href="#fnref-4" class="footnote-backref">↩</a></p></li><li id="fn-5"><p>Leonard Richardson, Sam Ruby. <a href="https://www.oreilly.com/library/view/restful-web-services/9780596529260/" target="_blank" rel="noopener noreferrer">RESTful Web Services</a> Ch. 4.</p><blockquote><p>A resource is anything that’s important enough to be referenced as a thing in itself. If your users might “want to create a hypertext link to it, make or refute assertions about it, retrieve or cache a representation of it, include all or part of it by reference into another representation, annotate it, or perform other operations on it”, then you should make it a resource.</p><p> Usually, a resource is something that can be stored on a computer and represented as a stream of bits: a document, a row in a database, or the result of running an algorithm.</p></blockquote><p><a href="#fnref-5" class="footnote-backref">↩</a></p></li><li id="fn-6"><p>我们并没有把&quot;entity&quot;翻译为&quot;实体&quot;是因为Kubernetes资源也可能是集群中一个&quot;虚拟&quot;的&quot;内容&quot;。我们接下来还会在本节<a href="#%E5%85%B6%E4%BB%96API%E6%9C%AF%E8%AF%AD">其他API术语</a>详细介绍它们；<a href="#fnref-6" class="footnote-backref">↩</a></p></li><li id="fn-7"><p><a href="https://kubernetes.io/docs/reference/using-api/" target="_blank" rel="noopener noreferrer">API Overview <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a></p><blockquote><p><a href="https://kubernetes.io/docs/reference/using-api/#api-groups" target="_blank" rel="noopener noreferrer">API groups</a></p><p>API groups make it easier to extend the Kubernetes API.</p></blockquote><p><a href="#fnref-7" class="footnote-backref">↩</a></p></li><li id="fn-8"><p><em>伪子域名</em>表示并非一定真实存在这样的域名，它仅指代一种风格。<a href="#fnref-8" class="footnote-backref">↩</a></p></li><li id="fn-9"><p><em>API URI</em>也可以理解成<em>API endpoint</em>、<em>API path</em>或者<em>API REST path</em>。这些术语在Kubernetes官方文档中等价并被交换使用。<a href="#fnref-9" class="footnote-backref">↩</a></p></li><li id="fn-10"><p><em>命名空间</em>的概念属于读者需要掌握的<a href="/crd-controller-from-scratch/docs/intro#%E8%B0%81%E9%80%82%E5%90%88%E9%98%85%E8%AF%BB%E6%9C%AC%E4%B9%A6">预备知识</a>之一，我们不在这里多做赘述。<a href="#fnref-10" class="footnote-backref">↩</a></p></li><li id="fn-11"><p>在这里，我们仅仅是引入了<em>kind</em>的概念，在后续章节中我们还会继续对<em>kind</em>作出更为全面的阐述。<a href="#fnref-11" class="footnote-backref">↩</a></p></li><li id="fn-12"><p><a href="https://github.com/kubernetes/kubernetes/blob/v1.1.0-beta/docs/proposals/api-group.md" target="_blank" rel="noopener noreferrer">Supporting multiple API groups <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a></p><blockquote><p><a href="https://github.com/kubernetes/kubernetes/blob/v1.1.0-beta/docs/proposals/api-group.md#bookkeeping-for-groups" target="_blank" rel="noopener noreferrer">Bookkeeping for groups</a></p><p>For a fast implementation targeting the v1.1 deadline, we will concatenate group with version, in the form of &quot;group/version&quot;, and use it where a version string is expected, so that many code can be reused.</p></blockquote><p><a href="#fnref-12" class="footnote-backref">↩</a></p></li><li id="fn-13"><p>这是我们能够找到关于<code>core</code>分组名称由来最早的记录：<a href="https://github.com/kubernetes/kubernetes/blob/v1.2.0-alpha.2/docs/api.md" target="_blank" rel="noopener noreferrer">API Conventions(v1.2.0-alpha.2) <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>。</p><blockquote><p><a href="https://github.com/kubernetes/kubernetes/blob/v1.2.0-alpha.2/docs/api.md#api-groups" target="_blank" rel="noopener noreferrer">API groups</a></p><p>Currently there are two API groups in use:</p><p> 1<!-- -->.<!-- --> the &quot;core&quot; group, which is at REST path /api/v1 and is not specified as part of the apiVersion field, e.g. apiVersion: v1.</p><p> 2<!-- -->.<!-- --> the &quot;extensions&quot; group, which is at REST path /apis/extensions/$VERSION, and which uses apiVersion: extensions/$VERSION (e.g. currently apiVersion: extensions/v1beta1).</p></blockquote><p>   另外，<code>core</code>分组在文档<a href="#https://kubernetes.io/docs/reference/using-api/#api-groups">API Overview <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a>中也被称为<em>历史遗留组（legacy group）</em>。<a href="#fnref-13" class="footnote-backref">↩</a></p></li><li id="fn-14"><p><a href="https://json-schema.org/" target="_blank" rel="noopener noreferrer">JSON Schema</a><a href="#fnref-14" class="footnote-backref">↩</a></p></li><li id="fn-15"><p>Kubernetes权限管理本身并不在本书讨论范围之内，请参考文档<a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/" target="_blank" rel="noopener noreferrer">authentication <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a>。<a href="#fnref-15" class="footnote-backref">↩</a></p></li><li id="fn-16"><p>在本节的<a href="#kubernetes%E5%AF%B9%E8%B1%A1kubernetes-object">kubernetes对象</a>我们会明确说明Kubernetes&quot;实体&quot;的具体含义。<a href="#fnref-16" class="footnote-backref">↩</a></p></li><li id="fn-17"><p><a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/" target="_blank" rel="noopener noreferrer">Objects In Kubernetes <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a></p><blockquote><p><a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/#object-spec-and-status" target="_blank" rel="noopener noreferrer">Object spec and status</a></p><p>Almost every Kubernetes object includes two nested object fields that govern the object&#x27;s configuration: the object spec and the object status. For objects that have a spec, you have to set this when you create the object, providing a description of the characteristics you want the resource to have: its desired state.</p><p>The status describes the current state of the object, supplied and updated by the Kubernetes system and its components.</p></blockquote><p><a href="#fnref-17" class="footnote-backref">↩</a></p></li><li id="fn-18"><p><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a></p><blockquote><p><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#spec-and-status" target="_blank" rel="noopener noreferrer">Spec and Status</a></p><p>Some objects which are not persisted in the system - such as SubjectAccessReview and other webhook style calls - may choose to add spec and status to encapsulate a &quot;call and response&quot; pattern.
The spec is the request (often a request for information) and the status is the response.</p></blockquote><p><a href="#fnref-18" class="footnote-backref">↩</a></p></li><li id="fn-19"><p><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/object-lifecycle.md" target="_blank" rel="noopener noreferrer">The API Object Lifecycle <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a></p><blockquote><p>The Kubernetes API (and related APIs in the ecosystem) defines &quot;objects&quot; (<strong>also called resources in REST context</strong>) which are created, managed, and deleted over time.</p></blockquote><p><a href="#fnref-19" class="footnote-backref">↩</a></p></li></ol></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/crd-controller-from-scratch/docs/apimachinery/apimachinery"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">apimachinery</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/crd-controller-from-scratch/docs/apimachinery/gvk"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GVK</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#kubernetes资源" class="table-of-contents__link toc-highlight">Kubernetes资源</a><ul><li><a href="#http与resource" class="table-of-contents__link toc-highlight">HTTP与Resource</a></li><li><a href="#从http资源到kubernetes资源初识kubernetes资源" class="table-of-contents__link toc-highlight">从HTTP资源到Kubernetes资源——初识Kubernetes资源</a></li></ul></li><li><a href="#api分组group和版本化version" class="table-of-contents__link toc-highlight">API分组（group）和版本化（version）</a></li><li><a href="#资源类型resource-type" class="table-of-contents__link toc-highlight">资源类型（resource type）</a></li><li><a href="#初识kind" class="table-of-contents__link toc-highlight">初识kind</a></li><li><a href="#从kubernetes-kind到kubernetes资源再识kubernetes资源" class="table-of-contents__link toc-highlight">从Kubernetes kind到Kubernetes资源——再识Kubernetes资源</a><ul><li><a href="#小结" class="table-of-contents__link toc-highlight">小结</a></li></ul></li><li><a href="#其它api术语" class="table-of-contents__link toc-highlight">其它API术语</a></li><li><a href="#初识kubernetes虚拟资源" class="table-of-contents__link toc-highlight">初识Kubernetes虚拟资源</a><ul><li><a href="#从kubernetes-api的声明式配置说起" class="table-of-contents__link toc-highlight">从Kubernetes API的声明式配置说起</a></li><li><a href="#kubernetes对象kubernetes-object" class="table-of-contents__link toc-highlight">Kubernetes对象（Kubernetes Object）</a></li><li><a href="#再识kubernetes虚拟资源" class="table-of-contents__link toc-highlight">再识Kubernetes虚拟资源</a></li></ul></li><li><a href="#子资源subresource" class="table-of-contents__link toc-highlight">子资源（subresource）</a></li><li><a href="#小结-1" class="table-of-contents__link toc-highlight">小结</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Xudong Wang, Under license <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a>, Built with Docusaurus.🎈</div></div></div></footer></div>
<script src="/crd-controller-from-scratch/assets/js/runtime~main.56e28771.js"></script>
<script src="/crd-controller-from-scratch/assets/js/main.66bc2718.js"></script>
</body>
</html>