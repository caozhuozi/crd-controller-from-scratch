<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-apimachinery/runtime.Object">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">runtime.Object | 《从零实现Kubernetes自定义控制器》</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://caozhuozi.github.io/crd-controller-from-scratch/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://caozhuozi.github.io/crd-controller-from-scratch/img/logo.png"><meta data-rh="true" property="og:url" content="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/runtime.Object"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="runtime.Object | 《从零实现Kubernetes自定义控制器》"><meta data-rh="true" name="description" content="在本节中，我们会基于Kubernetes源码（k8s.io/api库和k8s.io/apimachinery库）进一步去诠释先前在再识kind引入的论述——&quot;在Kubernetes中，所有需要被序列化/反序列化的Go类型都被称为kind&quot;。"><meta data-rh="true" property="og:description" content="在本节中，我们会基于Kubernetes源码（k8s.io/api库和k8s.io/apimachinery库）进一步去诠释先前在再识kind引入的论述——&quot;在Kubernetes中，所有需要被序列化/反序列化的Go类型都被称为kind&quot;。"><link data-rh="true" rel="icon" href="/crd-controller-from-scratch/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/runtime.Object"><link data-rh="true" rel="alternate" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/runtime.Object" hreflang="en"><link data-rh="true" rel="alternate" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/apimachinery/runtime.Object" hreflang="x-default"><link rel="stylesheet" href="/crd-controller-from-scratch/assets/css/styles.37df9119.css">
<link rel="preload" href="/crd-controller-from-scratch/assets/js/runtime~main.56e28771.js" as="script">
<link rel="preload" href="/crd-controller-from-scratch/assets/js/main.66bc2718.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#e6f6e6;color:#5f805b" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">🥳v0.6.0-rc2 is released.🎉</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/crd-controller-from-scratch/"><div class="navbar__logo"><img src="/crd-controller-from-scratch/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/crd-controller-from-scratch/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/crd-controller-from-scratch/docs/intro">开始</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/caozhuozi/crd-controller-from-scratch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/crd-controller-from-scratch/docs/intro">前言</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/crd-controller-from-scratch/docs/apimachinery/apimachinery">apimachinery</a><button aria-label="Toggle the collapsible sidebar category &#x27;apimachinery&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/kubernetes-api">从Kubernetes API谈起</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/gvk">GVK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/runtime.Object">runtime.Object</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/kind-case-study">kind案例探究</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/serializer">序列化器与序列化器工厂</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/client-go-and-apimachinery">client-go与apimachinery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/apimachinery/summary">本章小结</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/crd-controller-from-scratch/docs/client-go/client-go">client-go</a><button aria-label="Toggle the collapsible sidebar category &#x27;client-go&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/crd-controller-from-scratch/docs/putting-it-all-together/putting-it-all-together">putting it all together</a><button aria-label="Toggle the collapsible sidebar category &#x27;putting it all together&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/crd-controller-from-scratch/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/crd-controller-from-scratch/docs/apimachinery/apimachinery"><span itemprop="name">apimachinery</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">runtime.Object</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>runtime.Object</h1><p>在本节中，我们会基于Kubernetes源码（<code>k8s.io/api</code>库和<code>k8s.io/apimachinery</code>库）进一步去诠释先前在<a href="/crd-controller-from-scratch/docs/apimachinery/gvk#%E5%86%8D%E8%AF%86kind">再识kind</a>引入的论述——&quot;在Kubernetes中，所有需要<strong>被序列化/反序列化</strong>的Go类型都被称为<em>kind</em>&quot;。</p><p>为了说明此论述，本节的主要内容包括：</p><ul><li><code>k8s.io/apimachinery</code>库中如何抽象Kubernetes API类型系统（<em>资源</em>/<em>kind</em>）；</li><li><code>k8s.io/apimachinery</code>库中对资源编/解码过程的一般行为。</li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>需要在这里强调的是，本小节的内容以文档<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>中关于<em>资源</em>/<em>kind</em>必须要遵循的约定为基础。
我们认为文档<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>是社区开发者想要在语言中立的情况下对Kubernetes API类型系统所做的规范，以便开发者可以依据规范利用不同的语言来实现客户端以及<em>控制器</em>。
所以，我们可以这样看待文档<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>与Kubernetes源码的关系——<code>k8s.io/api</code>库和<code>k8s.io/apimachinery</code>库是基于该文档的一种实现方案。</p><p>当然，文档<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>本身是后于Kubernetes源码产生的，与其说社区开发者想要保证&quot;语言中立&quot;，不如说文档中的约定其实是对Kubernetes源码中API类型实现上的总结。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🌧️</a></p><p>在本小节中我们将结合Kubernetes源码（Go语言）对该文档做进一步的诠释。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kind与runtimeobject">kind与runtime.Object<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup><a href="#kind与runtimeobject" class="hash-link" aria-label="Direct link to kind与runtimeobject" title="Direct link to kind与runtimeobject">​</a></h2><p>在之前的小节中，我们知道了在Kubernetes中，<em>kind</em>是某一类Go类型（如<code>type Pod struct {...}</code>，<code>type Service struct {...}</code>）的统称。
这算是一种文字上的总结。
那么在Kubernetes中，如何从源码角度去描述&quot;所有类型都属于&quot;这种文字性质的总结呢？
在Go语言中，我们知道<em>接口（interface）</em>提供了一种抽象能力，所以我们可以通过“所有实现了某个接口的对象都被称为kind”来体现这种文字上的抽象。</p><p>事实也的确如此，在Kubernetes源码中，所有<em>kind</em>（<code>k8s.io/api</code>）其实都实现了<code>apimachinery</code>库中的<code>runtime.Object</code>接口。
换一种叙述方式，也就是：<strong>在Kubernetes中，所有实现了<code>runtime.Object</code>接口的Go类型被称为<em>kind</em></strong>。</p><p>下图展示了<code>k8s.io/api</code>库中定义的<em>kind</em>与<code>k8s.io/apimachinery</code>库中的基础接口的关系：</p><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 728.313 715.393" width="728.313" height="715.393" style="height:560px"><defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><g stroke-opacity="0.6" fill-opacity="0.6" stroke-linecap="round"><path d="M279.206 10h245v129h-245" stroke-width="0" fill="#ced4da"></path><path d="M279.206 10h245m-245 0h245m0 0v129m0-129v129m0 0h-245m245 0h-245m0 0V10m0 129V10" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(284.206 15)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/api/batch/v1</text><g stroke-opacity="0.6" fill-opacity="0.6"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(293.576 47.447)">type Job struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(293.576 47.447)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(293.576 47.447)">}</text></g><g stroke-linecap="round"><path d="M244.993 69.006h245v129h-245" stroke-width="0" fill="#e2e5e9"></path><path d="M244.993 69.006h245m-245 0h245m0 0v129m0-129v129m0 0h-245m245 0h-245m0 0v-129m0 129v-129" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(249.993 74.006)">k8s.io/api/apps/v1</text><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(259.363 106.454)">type Deployment struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(259.363 106.454)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(259.363 106.454)">}</text><g stroke-linecap="round"><path d="M231.387 131.374h223v129h-223" stroke-width="0" fill="#ced4da"></path><path d="M231.387 131.374h223m-223 0h223m0 0v129m0-129v129m0 0h-223m223 0h-223m0 0v-129m0 129v-129" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(236.387 136.374)">k8s.io/api/core/v1</text><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(245.757 168.821)">type Pod struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(245.757 168.821)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(245.757 168.821)">}</text><g stroke-opacity="0.7" fill-opacity="0.7" stroke-linecap="round"><path d="M178.681 362.732h372v150h-372" stroke-width="0" fill="#f9f7ed"></path><path d="M178.681 362.732h372m-372 0h372m0 0v150m0-150v150m0 0h-372m372 0h-372m0 0v-150m0 150v-150" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(183.681 367.732)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/apimachinery/pkgs/runtime</text><g stroke-opacity="0.8" fill-opacity="0.8"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(191.346 416.998)">type Object interface {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(191.346 416.998)">    GetObjectKind() schema.ObjectKind</text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(191.346 416.998)">    DeepCopyObject() Object</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(191.346 416.998)">}</text></g><g stroke-linecap="round"><path d="M347.047 264.427c-.01 18.85-.03 37.71-.07 89.08m.07-89.08c-.02 21.16-.03 42.33-.07 89.08" stroke="#000" stroke-width="2" fill="none"></path><path d="m346.977 353.507-6.33-13.6 12.68.01-6.35 13.59" stroke-width="0" fill-rule="evenodd"></path><path d="m346.977 353.507-6.33-13.6m6.33 13.6c-1.5-3.23-3.01-6.46-6.33-13.6m0 0c3.07 0 6.15.01 12.68.01m-12.68-.01c4.04 0 8.07.01 12.68.01m0 0c-2 4.29-4.01 8.58-6.35 13.59m6.35-13.59c-2.24 4.8-4.48 9.59-6.35 13.59m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g><g stroke-opacity="0.7" fill-opacity="0.7" stroke-linecap="round"><path d="M139.517 555.393h446v150h-446" stroke-width="0" fill="#f9f7ed"></path><path d="M139.517 555.393h446m-446 0h446m0 0v150m0-150v150m0 0h-446m446 0h-446m0 0v-150m0 150v-150" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(144.517 560.393)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/apimachinery/pkgs/runtime</text><g stroke-opacity="0.8" fill-opacity="0.8"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(152.182 609.66)">type ObjectKind interface {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(152.182 609.66)">    SetGroupVersionKind(kind GroupVersionKind)</text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(152.182 609.66)">    GroupVersionKind() GroupVersionKind</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(152.182 609.66)">}</text></g><g stroke-linecap="round"><path d="M545.456 443.02c3.81 6.6 19.04 21.73 22.85 39.58 3.81 17.85 0 56.26 0 67.51" stroke="#000" stroke-width="2.5" fill="none" stroke-dasharray="1.5 8" stroke-opacity="0.5" fill-opacity="0.5"></path><g stroke-opacity="0.5" fill-opacity="0.5"><path d="m568.306 550.11-5.73-13.86 12.67.57-6.94 13.29" stroke-width="0" fill-rule="evenodd"></path><path d="M568.306 550.11c-1.68-4.07-3.36-8.14-5.73-13.86m0 0c3.63.16 7.26.32 12.67.57m0 0c-2.47 4.72-4.93 9.45-6.94 13.29m0 0s0 0 0 0" stroke="#000" stroke-width="2.5" fill="none"></path></g></g><path d="M10 307.858h708.31" stroke="#000" stroke-width="2.5" fill="none" stroke-dasharray="8 10" stroke-opacity="0.5" fill-opacity="0.5" stroke-linecap="round"></path><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="rotate(.025 -717260.134 1193790.336)" stroke-opacity="0.6" fill-opacity="0.6">©Xudong Wang🤖️🎈</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(17.655 268.184)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/api</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(15.507 324.057)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/apimachinery</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(621.037 148.51)">kind</text><g stroke-linecap="round"><path d="M614.843 167.329c-11.43 6.54-42.57 31.27-68.58 39.21-26.01 7.94-72.9 7.04-87.48 8.45m156.06-47.66c-11.43 6.54-42.57 31.27-68.58 39.21-26.01 7.94-72.9 7.04-87.48 8.45" stroke="#000" stroke-width="2" fill="none" stroke-opacity="0.5" fill-opacity="0.5"></path><g stroke-opacity="0.5" fill-opacity="0.5"><path d="m458.783 214.989 13.29-6.96.58 12.66-13.87-5.7" stroke-width="0" fill-rule="evenodd"></path><path d="M458.783 214.989c3.44-1.8 6.88-3.61 13.29-6.96m-13.29 6.96c5.05-2.65 10.11-5.3 13.29-6.96m0 0 .58 12.66m-.58-12.66c.21 4.69.43 9.39.58 12.66m0 0c-5.24-2.15-10.49-4.31-13.87-5.7m13.87 5.7c-4.75-1.95-9.51-3.91-13.87-5.7m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g></g><g stroke-linecap="round"><path d="M612.762 157.538h-99m99 0h-99" stroke="#000" stroke-width="2" fill="none" stroke-opacity="0.5" fill-opacity="0.5"></path><g stroke-opacity="0.5" fill-opacity="0.5"><path d="m513.762 157.538 13.6-6.34v12.68l-13.6-6.34" stroke-width="0" fill-rule="evenodd"></path><path d="M513.762 157.538c2.99-1.39 5.97-2.78 13.6-6.34m-13.6 6.34c4.27-1.99 8.55-3.98 13.6-6.34m0 0v12.68m0-12.68v12.68m0 0c-3.73-1.74-7.47-3.48-13.6-6.34m13.6 6.34c-3.88-1.81-7.75-3.61-13.6-6.34m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g></g><g stroke-linecap="round"><path d="M618.799 148.797c-4.37-7.4-14.55-35.02-26.22-44.37-11.68-9.36-36.53-9.79-43.84-11.75m70.06 56.12c-4.37-7.4-14.55-35.02-26.22-44.37-11.68-9.36-36.53-9.79-43.84-11.75" stroke="#000" stroke-width="2" fill="none" stroke-opacity="0.5" fill-opacity="0.5"></path><g stroke-opacity="0.5" fill-opacity="0.5"><path d="m548.739 92.677 14.41-4.17-1.95 12.53-12.46-8.36" stroke-width="0" fill-rule="evenodd"></path><path d="M548.739 92.677c3.74-1.08 7.49-2.17 14.41-4.17m-14.41 4.17c4.72-1.37 9.44-2.73 14.41-4.17m0 0c-.61 3.9-1.21 7.79-1.95 12.53m1.95-12.53c-.59 3.77-1.17 7.54-1.95 12.53m0 0c-4.3-2.89-8.6-5.77-12.46-8.36m12.46 8.36c-2.74-1.84-5.48-3.68-12.46-8.36m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g></g></svg><p>我们先来看看<code>runtime.Object</code>接口的具体定义：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/runtime/interfaces.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Object </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetObjectKind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ObjectKind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">DeepCopyObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这个接口包含两个方法：</p><ol><li><p><code>GetObjectKind()</code>返回的是<strong>另一个</strong><code>schema.ObjectKind</code>接口：</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>schema.ObjectKind接口</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/runtime/schema/interfaces.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> ObjectKind </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetGroupVersionKind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kind GroupVersionKind</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GroupVersionKind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> GroupVersionKind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p><code>schema.ObjectKind</code>接口的两个方法用于获取及设置<em>GVK</em>信息。
总之，<code>runtime.Object</code>的第一个方法实际上规范了实现类必须能够获取/设置本类型对应的<em>GVK</em>信息。</p></li><li><p><code>DeepCopyObject()</code> 看起来是个非常基础的方法，即实现类需要提供一个能够深拷贝自身的方法。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🎈</a></p></li></ol><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>相比于在之前小节中对<em>kind</em>偏向于概念性的总结，在本小节中，我们侧重于真正从源码实现的角度给出<em>kind</em>的定义。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="metav1typemeta">metav1.TypeMeta<a href="#metav1typemeta" class="hash-link" aria-label="Direct link to metav1.TypeMeta" title="Direct link to metav1.TypeMeta">​</a></h3><p>另外，需要在这里提及的是在<code>apimachinery</code>库中，<code>metav1.TypeMeta</code>这个元类型<sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>实现了<code>runtime.Object</code>接口的<strong>第一个方法</strong><code>GetObjectKind() schema.ObjectKind</code>。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🎈</a></p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>apimachinery库的metav1.TypeMeta元类型</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/apis/meta/v1/types.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> TypeMeta </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Kind </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;kind,omitempty&quot; protobuf:&quot;bytes,1,opt,name=kind&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    APIVersion </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;apiVersion,omitempty&quot; protobuf:&quot;bytes,2,opt,name=apiVersion&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/apis/meta/v1/meta.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">TypeMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetObjectKind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ObjectKind </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> obj </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>在具体实现上，它包含的类成员命名也符合<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#resources" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>中关于<em>kind</em>元字段名称的要求。
根据约定，文档要求<em>Kubernetes资源</em>必须有名为<code>kind</code>以及<code>apiversion</code>字段分别表示类型名称以及分组和版本信息：</p><blockquote><p><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#resources" target="_blank" rel="noopener noreferrer">Resources</a></p><p>All JSON objects returned by an API MUST have the following fields:</p><ul><li>kind: a string that identifies the schema this object should have</li><li>apiVersion: a string that identifies the version of the schema the object should have</li></ul><p>These fields are required for proper decoding of the object.</p></blockquote><p>意思是说，<code>kind</code>和<code>apiVersion</code>这两个字段需要用于解码（反序列化）资源。</p><p><code>apimachinery</code>库中与反序列化资源有关的代码也确实会<strong>检查这两个字段以分析得出资源的GVK信息</strong>：</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>apimachinery库中序列化资源时推断GVK信息的逻辑</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/api/meta/help.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SimpleMetaFactory</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Interpret</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GroupVersionKind</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     findKind </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// +optional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        APIVersion </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;apiVersion,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// +optional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Kind </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;kind,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unmarshal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">findKind</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Errorf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;couldn&#x27;t get version/kind; json parse error: %v&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     gv</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ParseGroupVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">findKind</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">APIVersion</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GroupVersionKind</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Version</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> findKind</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Kind</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>这只是<code>apimachinery</code>库反序列化最初的步骤。在后续小节<a href="/crd-controller-from-scratch/docs/apimachinery/serializer">序列化器与序列化器工厂</a>中，我们还会进一步介绍<code>apimachinery</code>库反序列化的后续步骤。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>我们在这里突然提及<code>metav1.TypeMeta</code>似乎有点&quot;唐突&quot;。
不过在本节，你只需要了解到这个事实即可。这个知识点是作为后续<a href="/crd-controller-from-scratch/docs/apimachinery/kind-case-study">kind案例探究</a>小节的预备知识而不得不在这里提前指出。</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小结</div><div class="admonitionContent_S0QG"><p>目前我们已经揭露了Kubernetes中<em>kind</em>这个概念与<code>apimachinery</code>库中<code>runtime.Object</code>接口的关系。</p><p>不过在之前的小节中，我们基于<a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.27/" target="_blank" rel="noopener noreferrer">Kubernetes API Reference Doc <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:nonzero;fill:#326ce5;fill-opacity:1" d="M7.945 0c-.14.008-.28.043-.41.102L1.973 2.668c-.29.137-.5.39-.575.691L.028 9.13a.976.976 0 0 0 .202.86l3.852 4.624c.203.242.508.387.832.387l6.172-.004c.324 0 .633-.14.832-.383l3.852-4.625a.987.987 0 0 0 .203-.863l-1.375-5.766a1.01 1.01 0 0 0-.575-.691L8.461.102C8.3.027 8.12-.008 7.945 0Zm0 0"></path><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M8 1.965c-.184 0-.332.16-.332.355v.012c0 .023-.004.059 0 .082.004.113.027.2.043.305.031.222.055.41.039.582a.382.382 0 0 1-.11.168l-.007.136c-.2.016-.403.043-.602.09a4.299 4.299 0 0 0-2.176 1.2l-.12-.082c-.06.007-.118.023-.196-.02a3.193 3.193 0 0 1-.45-.39c-.073-.079-.128-.153-.218-.227-.02-.016-.05-.04-.074-.055a.411.411 0 0 0-.235-.086.328.328 0 0 0-.265.113c-.113.141-.074.352.082.477h.008c.02.02.047.04.066.055.098.066.184.101.277.156.2.117.364.219.497.336.05.055.058.144.066.187l.105.09a4.057 4.057 0 0 0-.68 2.903l-.136.039c-.039.046-.09.117-.144.14-.172.051-.364.07-.598.094-.11.008-.203.004-.32.023a.554.554 0 0 1-.086.02l-.004.004h-.004c-.2.047-.324.219-.281.39.039.172.23.278.43.235h.007c.031-.008.063-.012.086-.02.117-.03.2-.074.3-.109.22-.078.403-.14.583-.168.074-.004.152.047.191.066l.145-.023a4.207 4.207 0 0 0 1.918 2.316l-.059.141c.02.055.047.129.027.18-.062.164-.175.336-.3.523-.059.09-.121.156-.176.258-.016.023-.031.062-.043.086-.086.18-.024.383.14.457.165.078.372-.004.458-.18h.003c.012-.027.028-.058.04-.082.046-.105.062-.195.097-.297.086-.215.137-.437.258-.578.031-.039.086-.05.145-.066l.074-.133a4.385 4.385 0 0 0 3.07.008c.024.035.063.105.074.125.055.015.117.027.168.097.09.153.153.329.23.543.032.102.048.188.094.293l.043.082c.09.18.293.262.461.184.164-.078.227-.281.141-.457-.012-.027-.031-.063-.043-.086-.055-.102-.117-.168-.18-.258-.125-.191-.23-.347-.293-.511-.027-.083.004-.133.024-.188-.012-.016-.04-.094-.055-.129a4.21 4.21 0 0 0 1.918-2.336c.043.008.117.02.145.027.05-.035.093-.074.183-.066.18.024.364.086.582.164.102.035.184.082.301.11.023.007.059.011.086.02h.004c.004 0 .004 0 .004.003.199.039.39-.066.43-.238.042-.172-.083-.344-.282-.39-.027-.009-.066-.017-.094-.024-.117-.02-.21-.016-.32-.024a3.314 3.314 0 0 1-.598-.094c-.07-.027-.12-.105-.144-.14l-.133-.04a4.065 4.065 0 0 0-.695-2.895c.035-.026.101-.085.117-.1.008-.059.004-.118.063-.18.132-.121.296-.219.496-.34.093-.05.183-.086.277-.152.023-.016.05-.043.074-.059.16-.125.195-.336.082-.472-.117-.141-.336-.153-.496-.032-.023.02-.055.04-.074.059-.09.074-.145.148-.223.223a2.991 2.991 0 0 1-.445.394c-.066.035-.16.024-.203.02l-.13.09a4.415 4.415 0 0 0-2.76-1.294 2.321 2.321 0 0 1-.009-.14c-.043-.043-.097-.074-.109-.164-.016-.172.008-.36.04-.582.015-.106.038-.192.042-.305.004-.027 0-.066 0-.094 0-.195-.148-.355-.332-.355Zm-.418 2.492-.098 1.688-.007.003a.292.292 0 0 1-.293.274.282.282 0 0 1-.172-.055h-.004l-1.434-.98a3.459 3.459 0 0 1 1.653-.867c.12-.028.238-.047.355-.063Zm.836 0a3.52 3.52 0 0 1 1.992.93l-1.422.976-.004-.004a.302.302 0 0 1-.402-.05.3.3 0 0 1-.066-.164ZM5.055 6.02l1.308 1.128v.008a.27.27 0 0 1 .035.387.28.28 0 0 1-.152.098v.007l-1.676.465a3.214 3.214 0 0 1 .485-2.093Zm5.879 0a3.262 3.262 0 0 1 .5 2.09L9.75 7.64v-.007a.282.282 0 0 1-.21-.336.306.306 0 0 1 .093-.152ZM7.73 7.234h.536l.336.403-.122.5-.48.226-.484-.226-.118-.5ZM9.45 8.61c.023 0 .046.004.066.008l.004-.004 1.734.282a3.347 3.347 0 0 1-1.39 1.683l-.673-1.57h.004c-.062-.14 0-.301.14-.367a.289.289 0 0 1 .114-.032Zm-2.915.008c.133.004.254.09.285.223a.285.285 0 0 1-.02.172l.009.008-.668 1.554a3.372 3.372 0 0 1-1.383-1.672l1.719-.285.003.004c.02-.004.04-.004.055-.004Zm1.453.68a.28.28 0 0 1 .137.031c.059.027.105.07.133.121h.008l.847 1.477a3.586 3.586 0 0 1-2.219 0l.844-1.477h.004a.29.29 0 0 1 .246-.152Zm0 0"></path></svg></a>将<em>kind</em>继续细分为了三个种类，
但也仍是基于文字性的叙述去描述每种分类。
其中<em>kind</em>的第三个种类过于特殊，在类型上没有具体要遵守的约定，因此我们不再深入研究。
对于<em>kind</em>的单体种类以及集合种类，它们在Kubernetes源码中也分别有对应的接口抽象。
下面我们将继续从Kubernetes源码角度探讨<em>kind</em>的单体种类以及集合种类的本质。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kind的单体种类与metav1object">kind的单体种类与metav1.Object<a href="#kind的单体种类与metav1object" class="hash-link" aria-label="Direct link to kind的单体种类与metav1.Object" title="Direct link to kind的单体种类与metav1.Object">​</a></h2><p>对于单体种类，由于它属于<em>kind</em>，根据先前的论述，它必然实现了<code>runtime.Object</code>接口。除此以外，作为单体种类，它们还需要实现<code>metav1.Object</code>接口：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pkg/apimachinery/pkg/api/meta/v1/meta.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Object </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetNamespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetNamespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">namespace </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetGenerateName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetGenerateName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetUID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetUID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uid types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetResourceVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetResourceVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>从接口的定义可以看出单体类型需要提供获取/设置一些元信息例如名称（name），命名空间（namespace），标签（labels）注解（annotations）等的方法。</p><p>下图以<code>Pod</code>类型为例，它其实实现了<code>runtime.Object</code>和<code>metav1.Object</code>两个接口：</p><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 669.827 500.084" width="669.827" height="500.084" style="height:420px"><defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><g stroke-linecap="round"><path d="M210.157 10h223v129h-223" stroke-width="0" fill="#ced4da"></path><path d="M210.157 10h223m-223 0h223m0 0v129m0-129v129m0 0h-223m223 0h-223m0 0V10m0 129V10" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(215.157 15)">k8s.io/api/core/v1</text><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(224.527 47.447)">type Pod struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(224.527 47.447)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(224.527 47.447)">}</text><g stroke-opacity="0.7" fill-opacity="0.7" stroke-linecap="round"><path d="M149.746 247.19h372v150h-372" stroke-width="0" fill="#f9f7ed"></path><path d="M149.746 247.19h372m-372 0h372m0 0v150m0-150v150m0 0h-372m372 0h-372m0 0v-150m0 150v-150" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(154.746 252.19)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/apimachinery/pkgs/runtime</text><g stroke-opacity="0.8" fill-opacity="0.8"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">type Object interface {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">    GetObjectKind() schema.ObjectKind</text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">    DeepCopyObject() Object</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">}</text></g><path d="M12.484 195.166h647.34" stroke="#000" stroke-width="2.5" fill="none" stroke-dasharray="8 10" stroke-opacity="0.5" fill-opacity="0.5" stroke-linecap="round"></path><g stroke-linecap="round"><path d="M75.518 322.084h338v168h-338" stroke-width="0" fill="#f9f7ed"></path><path d="M75.518 322.084h338m-338 0h338m0 0v168m0-168v168m0 0h-338m338 0h-338m0 0v-168m0 168v-168" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(80.518 327.084)">k8s.io/apimachinery/pkgs/meta/v1</text><g stroke-opacity="0.8" fill-opacity="0.8"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.988)">type Object interface {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.988)">    GetNamespace() string</text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.988)">    SetNamespace(namespace string)</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.988)">    GetName() string</text><text y="76.8" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.988)">    SetName(name string)</text><text y="96" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.988)">}</text></g><g stroke-linecap="round"><path d="M320.235 143.703c3.05 7.14 14.93 27.9 18.3 42.82 3.38 14.92 1.63 38.9 1.96 46.68m-20.26-89.5c3.05 7.14 14.93 27.9 18.3 42.82 3.38 14.92 1.63 38.9 1.96 46.68" stroke="#000" stroke-width="2" fill="none" stroke-opacity="0.7" fill-opacity="0.7"></path><g stroke-opacity="0.7" fill-opacity="0.7"><path d="m340.495 233.203-6.25-13.63 12.68.08-6.43 13.55" stroke-width="0" fill-rule="evenodd"></path><path d="M340.495 233.203c-2.26-4.93-4.52-9.85-6.25-13.63m6.25 13.63c-1.63-3.55-3.26-7.11-6.25-13.63m0 0c3.91.02 7.81.05 12.68.08m-12.68-.08c4.41.03 8.83.06 12.68.08m0 0c-2.49 5.25-4.99 10.5-6.43 13.55m6.43-13.55c-2.14 4.51-4.28 9.01-6.43 13.55m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g></g><g stroke-linecap="round"><path d="M320.084 143.127c-6.38 14.28-31.9 58.82-38.28 85.66-6.38 26.84 0 62.82 0 75.39m38.28-161.05c-6.38 14.28-31.9 58.82-38.28 85.66-6.38 26.84 0 62.82 0 75.39" stroke="#000" stroke-width="2" fill="none"></path><path d="m281.804 304.177-7.3-13.11 12.65-.91-5.35 14.02" stroke-width="0" fill-rule="evenodd"></path><path d="M281.804 304.177c-2.38-4.29-4.77-8.58-7.3-13.11m7.3 13.11c-2.41-4.33-4.82-8.67-7.3-13.11m0 0c3.56-.25 7.11-.51 12.65-.91m-12.65.91c3.67-.26 7.33-.53 12.65-.91m0 0c-1.54 4.05-3.09 8.09-5.35 14.02m5.35-14.02c-1.91 5-3.81 10-5.35 14.02m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(10 151.81)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/api</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(11.292 210.109)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/apimachinery</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="rotate(.025 -462098.338 1041869.152)" stroke-opacity="0.6" fill-opacity="0.6">©Xudong Wang🤖️🎈</text></svg><h3 class="anchor anchorWithStickyNavbar_LWe7" id="metav1objectmeta元类型">metav1.ObjectMeta元类型<a href="#metav1objectmeta元类型" class="hash-link" aria-label="Direct link to metav1.ObjectMeta元类型" title="Direct link to metav1.ObjectMeta元类型">​</a></h3><p>另外，有必要在本节提及的是<code>apimachinery</code>库中，
<code>metav1.ObjectMeta</code>元类型实现了<code>metav1.Object</code>接口。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🎈</a></p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>metav1.ObjectMeta元类型</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/apis/meta/v1/types.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ObjectMeta is metadata that all persisted resources must have, which includes all objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// users must create.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> ObjectMeta </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Name </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;name,omitempty&quot; protobuf:&quot;bytes,1,opt,name=name&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GenerateName </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;generateName,omitempty&quot; protobuf:&quot;bytes,2,opt,name=generateName&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Namespace </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;namespace,omitempty&quot; protobuf:&quot;bytes,3,opt,name=namespace&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelfLink </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;selfLink,omitempty&quot; protobuf:&quot;bytes,4,opt,name=selfLink&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UID types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UID </span><span class="token string" style="color:#e3116c">`json:&quot;uid,omitempty&quot; protobuf:&quot;bytes,5,opt,name=uid,casttype=k8s.io/kubernetes/pkg/types.UID&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResourceVersion </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;resourceVersion,omitempty&quot; protobuf:&quot;bytes,6,opt,name=resourceVersion&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Generation </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;generation,omitempty&quot; protobuf:&quot;varint,7,opt,name=generation&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CreationTimestamp Time </span><span class="token string" style="color:#e3116c">`json:&quot;creationTimestamp,omitempty&quot; protobuf:&quot;bytes,8,opt,name=creationTimestamp&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DeletionTimestamp </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Time </span><span class="token string" style="color:#e3116c">`json:&quot;deletionTimestamp,omitempty&quot; protobuf:&quot;bytes,9,opt,name=deletionTimestamp&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DeletionGracePeriodSeconds </span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;deletionGracePeriodSeconds,omitempty&quot; protobuf:&quot;varint,10,opt,name=deletionGracePeriodSeconds&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Labels </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;labels,omitempty&quot; protobuf:&quot;bytes,11,rep,name=labels&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Annotations </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;annotations,omitempty&quot; protobuf:&quot;bytes,12,rep,name=annotations&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OwnerReferences </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">OwnerReference </span><span class="token string" style="color:#e3116c">`json:&quot;ownerReferences,omitempty&quot; patchStrategy:&quot;merge&quot; patchMergeKey:&quot;uid&quot; protobuf:&quot;bytes,13,rep,name=ownerReferences&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Finalizers </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;finalizers,omitempty&quot; patchStrategy:&quot;merge&quot; protobuf:&quot;bytes,14,rep,name=finalizers&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ManagedFields </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">ManagedFieldsEntry </span><span class="token string" style="color:#e3116c">`json:&quot;managedFields,omitempty&quot; protobuf:&quot;bytes,17,rep,name=managedFields&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/apis/meta/v1/meta.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetNamespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Namespace </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetNamespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">namespace </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Namespace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> namespace </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain">                     </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> name </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetGenerateName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain">             </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GenerateName </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetGenerateName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">generateName </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GenerateName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generateName </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetUID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UID                   </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UID </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetUID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uid types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> uid </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetResourceVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResourceVersion </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetResourceVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResourceVersion </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> version </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetGeneration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">int64</span><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Generation </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetGeneration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">generation </span><span class="token builtin">int64</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Generation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generation </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetSelfLink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SelfLink </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetSelfLink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">selfLink </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SelfLink </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> selfLink </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetCreationTimestamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Time          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CreationTimestamp </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetCreationTimestamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">creationTimestamp Time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CreationTimestamp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> creationTimestamp </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetDeletionTimestamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Time </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DeletionTimestamp </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetDeletionTimestamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deletionTimestamp </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DeletionTimestamp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> deletionTimestamp </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetDeletionGracePeriodSeconds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DeletionGracePeriodSeconds </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetDeletionGracePeriodSeconds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deletionGracePeriodSeconds </span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">int64</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DeletionGracePeriodSeconds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> deletionGracePeriodSeconds </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetLabels</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Labels </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetLabels</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">labels </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> labels </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetAnnotations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Annotations </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetAnnotations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">annotations </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Annotations </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> annotations </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetFinalizers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Finalizers </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetFinalizers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finalizers </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Finalizers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> finalizers </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetOwnerReferences</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">OwnerReference         </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">OwnerReferences </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetOwnerReferences</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">references </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">OwnerReference</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">OwnerReferences </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> references </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetManagedFields</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">ManagedFieldsEntry </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ManagedFields </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">meta </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ObjectMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetManagedFields</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">managedFields </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">ManagedFieldsEntry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ManagedFields </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> managedFields </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>在具体实现上，<code>metav1.Object</code>类成员命名也符合<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#objects" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>中关于单体类型元字段的规范。</p><p>根据文档<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#objects" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>，对于单体种类，它们<strong>必须</strong>包含名为<code>metadata</code>的字段，同时在<code>metadata</code>字段下由<strong>必须</strong>要有名为<code>namespace</code>，<code>name</code>，<code>uid</code>等字段。
另外，它们<strong>应该</strong>带有<code>resourceVersion</code>，<code>generation</code>，<code>labels</code>，<code>annotations</code>，<code>deletionTimestamp</code>，<code>creationTimestamp</code>等字段。</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>单体类型的实现约定</summary><div><div class="collapsibleContent_i85q"><blockquote><p><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#objects" target="_blank" rel="noopener noreferrer">Objects</a></p><p>Metadata
Every object kind MUST have the following metadata in a nested object field called &quot;metadata&quot;:</p><ul><li>namespace: a namespace is a DNS compatible label that objects are subdivided into. The default namespace is &#x27;default&#x27;. See the namespace docs for more.</li><li>name: a string that uniquely identifies this object within the current namespace (see the identifiers docs). This value is used in the path when retrieving an individual object.</li><li>uid: a unique in time and space value (typically an RFC 4122 generated identifier, see the identifiers docs) used to distinguish between objects with the same name that have been deleted and recreated</li></ul><p>Every object SHOULD have the following metadata in a nested object field called &quot;metadata&quot;:</p><ul><li>resourceVersion: a string that identifies the internal version of this object that can be used by clients to determine when objects have changed. This value MUST be treated as opaque by clients and passed unmodified back to the server. Clients should not assume that the resource version has meaning across namespaces, different kinds of resources, or different servers. (See concurrency control, below, for more details.)</li><li>generation: a sequence number representing a specific generation of the desired state. Set by the system and monotonically increasing, per-resource. May be compared, such as for RAW and WAW consistency.</li><li>creationTimestamp: a string representing an RFC 3339 date of the date and time an object was created</li><li>deletionTimestamp: a string representing an RFC 3339 date of the date and time after which this resource will be deleted. This field is set by the server when a graceful deletion is requested by the user, and is not directly settable by a client. The resource will be deleted (no longer visible from resource lists, and not reachable by name) after the time in this field except when the object has a finalizer set. In case the finalizer is set the deletion of the object is postponed at least until the finalizer is removed. Once the deletionTimestamp is set, this value may not be unset or be set further into the future, although it may be shortened or the resource may be deleted prior to this time.</li><li>labels: a map of string keys and values that can be used to organize and categorize objects (see the labels docs)</li><li>annotations: a map of string keys and values that can be used by external tooling to store and retrieve arbitrary metadata about this object (see the annotations docs)</li></ul></blockquote></div></div></details><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>我们目前为止只是陈述了<em>kind</em>中的单体种类（如<code>Pod</code>）实现了<code>metav1.Object</code>接口这个事实。但是却没有
补充kind中的<em>单体种类</em>是如何实现<code>metav1.Object</code>的具体细节。
在后续<a href="/crd-controller-from-scratch/docs/apimachinery/kind-case-study">kind案例探究</a>小节我们还会解释具体的<em>kind</em>（<code>k8s.io/api</code>）是如何利用元类型（<code>k8s.io/apimachinery</code>）来间接实现这些抽象接口的——这也是我们在本节提及<code>k8s.io/apimachinery</code>库中元类型的动机。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="集合种类">集合种类<a href="#集合种类" class="hash-link" aria-label="Direct link to 集合种类" title="Direct link to 集合种类">​</a></h3><p>对于集合种类，除了要实现<code>runtime.Object</code>接口外，它们还需要实现<code>metav1.ListInterface</code>接口：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pkg/apis/meta/v1/meta.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> ListInterface </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetResourceVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetResourceVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetSelfLink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetSelfLink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">selfLink </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetContinue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetContinue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetRemainingItemCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">int64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SetRemainingItemCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">int64</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>下图以<code>PodList</code>类型为例，展示了它所实现的两个接口：</p><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 662.714 500.084" width="662.714" height="500.084" style="height:420px"><defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><g stroke-linecap="round"><path d="M210.157 10h223v129h-223" stroke-width="0" fill="#ced4da"></path><path d="M210.157 10h223m-223 0h223m0 0v129m0-129v129m0 0h-223m223 0h-223m0 0V10m0 129V10" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(215.157 15)">k8s.io/api/core/v1</text><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(224.527 47.447)">type PodList struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(224.527 47.447)">    Items []Pod</text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(224.527 47.447)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(224.527 47.447)">}</text><g stroke-opacity="0.7" fill-opacity="0.7" stroke-linecap="round"><path d="M149.746 247.19h372v150h-372" stroke-width="0" fill="#f9f7ed"></path><path d="M149.746 247.19h372m-372 0h372m0 0v150m0-150v150m0 0h-372m372 0h-372m0 0v-150m0 150v-150" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(154.746 252.19)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/apimachinery/pkgs/runtime</text><g stroke-opacity="0.8" fill-opacity="0.8"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">type Object interface {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">    GetObjectKind() schema.ObjectKind</text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">    DeepCopyObject() Object</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(162.41 301.456)">}</text></g><path d="M12.484 195.166h640.23" stroke="#000" stroke-width="2.5" fill="none" stroke-dasharray="8 10" stroke-opacity="0.5" fill-opacity="0.5" stroke-linecap="round"></path><g stroke-linecap="round"><path d="M75.518 322.084h374v168h-374" stroke-width="0" fill="#f9f7ed"></path><path d="M75.518 322.084h374m-374 0h374m0 0v168m0-168v168m0 0h-374m374 0h-374m0 0v-168m0 168v-168" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(80.518 327.084)">k8s.io/apimachinery/pkgs/meta/v1</text><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.842)">type ListInterface interface {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.842)">    GetResourceVersion() string</text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.842)">    SetResourceVersion(version string)</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.842)">    // ...   </text><text y="76.8" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(88.183 368.842)">}</text><g stroke-linecap="round"><path d="M320.235 143.703c3.05 7.14 14.93 27.9 18.3 42.82 3.38 14.92 1.63 38.9 1.96 46.68m-20.26-89.5c3.05 7.14 14.93 27.9 18.3 42.82 3.38 14.92 1.63 38.9 1.96 46.68" stroke="#000" stroke-width="2" fill="none" stroke-opacity="0.7" fill-opacity="0.7"></path><g stroke-opacity="0.7" fill-opacity="0.7"><path d="m340.495 233.203-6.25-13.63 12.68.08-6.43 13.55" stroke-width="0" fill-rule="evenodd"></path><path d="M340.495 233.203c-2.03-4.42-4.06-8.84-6.25-13.63m6.25 13.63c-1.4-3.06-2.81-6.12-6.25-13.63m0 0c3.45.02 6.9.04 12.68.08m-12.68-.08c4.95.03 9.89.06 12.68.08m0 0c-2.48 5.22-4.95 10.43-6.43 13.55m6.43-13.55c-1.33 2.79-2.65 5.58-6.43 13.55m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g></g><g stroke-linecap="round"><path d="M319.962 144.828c-6.36 14.02-31.56 57.93-38.16 84.1-6.59 26.17-1.17 60.77-1.41 72.92m39.57-157.02c-6.36 14.02-31.56 57.93-38.16 84.1-6.59 26.17-1.17 60.77-1.41 72.92" stroke="#000" stroke-width="2" fill="none"></path><path d="m280.392 301.848-7.03-13.24 12.66-.66-5.63 13.9" stroke-width="0" fill-rule="evenodd"></path><path d="M280.392 301.848c-1.41-2.65-2.82-5.3-7.03-13.24m7.03 13.24c-2.1-3.95-4.2-7.9-7.03-13.24m0 0c2.8-.15 5.6-.29 12.66-.66m-12.66.66 12.66-.66m0 0c-1.3 3.22-2.61 6.44-5.63 13.9m5.63-13.9c-2.18 5.38-4.36 10.77-5.63 13.9m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(10 151.81)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/api</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(11.292 210.109)" stroke-opacity="0.6" fill-opacity="0.6">k8s.io/apimachinery</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="rotate(.025 -455740.45 1040020.308)" stroke-opacity="0.6" fill-opacity="0.6">©Xudong Wang🤖️🎈</text></svg><p>根据<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>，集合种类在实现上还<strong>必须</strong>要包含名为<code>Items</code>的数组，并且类型名称必须要以&quot;List&quot;结尾。</p><blockquote><p>Lists are collections of resources of one (usually) or more (occasionally) kinds.</p><p>The name of a list kind must end with &quot;List&quot;. Lists have a limited set of common metadata. All lists use the required &quot;items&quot; field to contain the array of objects they return. Any kind that has the &quot;items&quot; field must be a list kind.</p></blockquote><p>另外，需要在这里提及的是在<code>apimachinery</code>库中，<code>metav1.ListMeta</code>类虽然实现了<code>metav1.ListInterface</code>接口，<strong>但是并没有包含<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>所要求的<code>Items</code>字段</strong>。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🎈</a></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>至于<code>metav1.ListMeta</code>没有加入<code>Items</code>的切片成员的原因，私以为可能是<code>metav1.ListInterface</code>接口本身就没有与<code>Items</code>相关的方法。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🌧️</a>
而<code>metav1.ListInterface</code>接口没有与<code>Items</code>相关的方法的原因可能是开发者本身设计上的疏忽。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🌧️</a>证据是：
在<code>apimachinery</code>库中有一个判断类型是否为集合种类的函数<code>IsListType</code>：</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>IsListType函数</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/api/meta/help.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// IsListType returns true if the provided Object has a slice called Items.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// TODO: Replace the code in this check with an interface comparison by</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// creating and enforcing that lists implement a list accessor.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">IsListType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> t </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Unstructured</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> reflect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TypeOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isListCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RLock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ok</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exists </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isListCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">byType</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isListCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RUnlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">exists </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token boolean" style="color:#36acaa">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getItemsPtr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ok </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// cache only the first 1024 types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isListCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isListCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">byType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            isListCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">byType</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isListCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p><code>IsListType</code>函数的函数文档中也明确说明了：</p><blockquote><p>IsListType returns true if the provided Object has a slice called Items.</p></blockquote><p>它是通过检查类型中是否存在一个<code>Items</code>的slice字段来判断类型是否为集合。
同时，在此函数的<code>TODO</code>信息中，我们可以看到这样一句话：</p><blockquote><p>TODO: Replace the code in this check with an interface comparison by
creating and enforcing that lists implement a list accessor.</p></blockquote><p>说明通过检查类型中是否含有<code>Items</code>字段在官方开发者看来确实并不是一个好的方式，通过检查类型是否实现了<code>metav1.ListInterface</code>接口来判断更具有说服力。
所以在将来<code>metav1.ListInterface</code>可能会加上类似于<code>GetItems()</code>的方法。<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">🌧️</a></p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小结</div><div class="admonitionContent_S0QG"><p>到现在为止我们总结了Kubernetes源码是如何遵循<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>中对<em>资源</em>/<em>kind</em>字段所做的约定。
具体来说，首先Kubernetes源码<code>k8s.io/apimachinery</code>库通过Go接口的方式抽象了文档中对于<em>单体种类</em>以及<em>集合种类</em>的具体要求。
其次<code>k8s.io/apimachinery</code>库中的元类型实现了所抽象的接口并在成员变量的设置上也符合<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#types-kinds" target="_blank" rel="noopener noreferrer">API Conventions <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg></a>对<em>资源</em>/<em>kind</em>需要所包含的元信息的要求。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="初识apimachinery库的序列化器">初识<sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup>apimachinery库的序列化器<a href="#初识apimachinery库的序列化器" class="hash-link" aria-label="Direct link to 初识apimachinery库的序列化器" title="Direct link to 初识apimachinery库的序列化器">​</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注</div><div class="admonitionContent_S0QG"><p>目前，我们似乎只论证了<em>kind</em>是指实现了<code>runtime.Object</code>的Go类型。然而本节最开始对<em>kind</em>的扩充定义是：所有需要<strong>被序列化/反序列化</strong>的Go类型都被称为<em>kind</em>&quot;。
接下来，我们将&quot;连带&quot;介绍<code>apimachinery</code>库中的序列化器与<code>runtime.Object</code>的关系以完整的论述本节开始对<em>kind</em>的扩充定义。</p></div></div><p><code>runtime.Object</code>接口本身其实并没有包含与编/解码直接相关的方法。
为了说清楚<code>runtime.Object</code>接口与编/解码的关系，我们需要从<code>apimachinery</code>库的序列化原理步骤说起。
我们在这里先直接给出结论，在后续<a href="/crd-controller-from-scratch/docs/apimachinery/serializer">序列化器与序列化器工厂</a>章节我们还会给出具体介绍<code>apimachinery</code>库的序列化原理。</p><p>在<code>apimachinery</code>库中，<strong>直接</strong>参与对kind编/解码操作的是<em>序列化器（serializers）</em><sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup>。
而<code>apimachinery</code>库中的序列化器依赖于一个叫做<code>runtime.Scheme</code><sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup>结构（也就是序列化器类型包含一个<code>runtime.Scheme</code>类型的成员）。
对于<code>runtime.Scheme</code>类型，你可以简单把它理解成一张Go类型的&quot;注册表&quot;。
<strong>只有在<code>scheme</code><sup id="fnref-6"><a href="#fn-6" class="footnote-ref">6</a></sup>结构中“注册”过的Go类型才可以被序列化器序编/解码</strong>。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="runtimescheme与kind">runtime.Scheme与kind<a href="#runtimescheme与kind" class="hash-link" aria-label="Direct link to runtime.Scheme与kind" title="Direct link to runtime.Scheme与kind">​</a></h2><p>在上一小节中，我们在介绍<code>apimachinery</code>库中的序列化器时引入了<code>runtime.Scheme</code>类型。
那么在前文所谓的“注册”类型具体指什么呢？
在<code>runtime.Scheme</code>中存在一个<code>map</code>类型的成员(映射表)<sup id="fnref-7"><a href="#fn-7" class="footnote-ref">7</a></sup>——<code>gvkToType</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/runtime/scheme.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Scheme </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    gvkToType </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GroupVersionKind</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">reflect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>同时，<code>runtime.Scheme</code>也对外提供了往此<code>map</code>中插入（注册）数据的方法：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/apimachinery/pkg/runtime/scheme.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Scheme</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddKnownTypeWithName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gvk schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GroupVersionKind</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj Object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们不需要关心这个方法的具体实现，我们现在只需要知道此方法可以将类型为<code>runtime.Object</code>（即参数<code>obj</code>）的对象以及对应的GVK信息（参数<code>gvk</code>）注册进<code>gvkToType</code>这张表中<sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup>。
也就是说，<code>Scheme</code>只能注册<strong><code>runtime.Object</code>类型的对象</strong>。
而根据之前的定义，<em>kind</em>就是实现了<code>runtime.Object</code>接口的Go类型的统称，所以，我们可以说<code>Scheme</code>类型用于注册kind。</p><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1279 823.555" width="1279" height="823.555" style="width:95%"><defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><g stroke-linecap="round"><path d="M544.266 690.555h191v123h-191" stroke-width="0" fill="#eae6ff"></path><path d="M544.266 690.555h191m-191 0h191m0 0v123m0-123v123m0 0h-191m191 0h-191m0 0v-123m0 123v-123" stroke="#000" fill="none"></path></g><text x="58.594" font-family="Cascadia, Segoe UI Emoji" font-size="20" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(581.172 784.555)">serializer</text><g stroke-linecap="round"><path d="M553.612 748.456h169.6" stroke="#449b82" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path><path d="m723.212 748.456-13.6 6.34v-12.68l13.6 6.34" stroke-width="0" fill="#449b82" fill-rule="evenodd"></path><path d="M723.212 748.456c-3.35 1.56-6.7 3.12-13.6 6.34m0 0v-12.68m0 0c5.18 2.42 10.37 4.84 13.6 6.34m0 0s0 0 0 0" stroke="#449b82" stroke-width="2.5" fill="none"></path></g><g stroke-linecap="round"><path d="M605.425 729.834h68v37h-68" stroke-width="0" fill="#f9f7ed"></path><path d="M605.425 729.834h68m-68 0h68m0 0v37m0-37v37m0 0h-68m68 0h-68m0 0v-37m0 37v-37" stroke="#000" fill="none"></path></g><text x="28.125" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(611.3 738.734)">scheme</text><g stroke-linecap="round"><path d="M10 10h1259v310H10" stroke-width="0" fill="#d5e8d4"></path><path d="M10 10h1259M10 10h1259m0 0v310m0-310v310m0 0H10m1259 0H10m0 0V10m0 310V10" stroke="#000" fill="none"></path></g><text x="82.031" font-family="Cascadia, Segoe UI Emoji" font-size="20" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(557.469 15)">runtime.Object</text><g stroke-linecap="round"><path d="M221.762 241.055h67v39h-67" stroke-width="0" fill="#f2ffff"></path><path d="M221.762 241.055h67m-67 0h67m0 0v39m0-39v39m0 0h-67m67 0h-67m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="28.125" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(227.137 250.955)">&amp;Job{}</text><g stroke-linecap="round"><path d="M22.37 241.055h199v39h-199" stroke-width="0" fill="#f2ffff"></path><path d="M22.37 241.055h199m-199 0h199m0 0v39m0-39v39m0 0h-199m199 0h-199m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(27.37 250.955)">{&quot;batch&quot;,&quot;v1&quot;,&quot;Job&quot;}</text><g stroke-linecap="round"><path d="M221.762 187.88h67v39h-67" stroke-width="0" fill="#f2ffff"></path><path d="M221.762 187.88h67m-67 0h67m0 0v39m0-39v39m0 0h-67m67 0h-67m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="28.125" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(227.137 197.78)">&amp;Pod{}</text><g stroke-linecap="round"><path d="M22.37 187.88h199v39h-199" stroke-width="0" fill="#f2ffff"></path><path d="M22.37 187.88h199m-199 0h199m0 0v39m0-39v39m0 0h-199m199 0h-199m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(27.37 197.78)">{&quot;&quot;,&quot;v1&quot;,&quot;Pod&quot;}</text><path d="M305.733 90.403v207.71M692.001 92.342v207.13" stroke="#000" stroke-width="1.5" fill="none" stroke-dasharray="8 9" stroke-linecap="round"></path><g stroke-linecap="round"><path d="M1087.873 187.88h165v39h-165" stroke-width="0" fill="#f2ffff"></path><path d="M1087.873 187.88h165m-165 0h165m0 0v39m0-39v39m0 0h-165m165 0h-165m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="65.625" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(1104.748 197.78)">&amp;ListOptions{}</text><g stroke-linecap="round"><path d="M713.482 187.88h374v39h-374" stroke-width="0" fill="#f2ffff"></path><path d="M713.482 187.88h374m-374 0h374m0 0v39m0-39v39m0 0h-374m374 0h-374m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="159.375" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(741.107 197.78)">{&quot;meta.k8s.io&quot;,&quot;v1&quot;,&quot;ListOptions&quot;}</text><g stroke-linecap="round"><path d="M1087.873 241.055h165v39h-165" stroke-width="0" fill="#f2ffff"></path><path d="M1087.873 241.055h165m-165 0h165m0 0v39m0-39v39m0 0h-165m165 0h-165m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="42.188" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(1128.186 250.955)">&amp;Status{}</text><g stroke-linecap="round"><path d="M713.482 241.055h374v39h-374" stroke-width="0" fill="#f2ffff"></path><path d="M713.482 241.055h374m-374 0h374m0 0v39m0-39v39m0 0h-374m374 0h-374m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="84.375" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(816.107 250.955)">{&quot;&quot;,&quot;v1&quot;,&quot;Status&quot;}</text><g stroke-linecap="round"><path d="M568.659 241.055h104v39h-104" stroke-width="0" fill="#f2ffff"></path><path d="M568.659 241.055h104m-104 0h104m0 0v39m0-39v39m0 0h-104m104 0h-104m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="46.875" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(573.784 250.955)">&amp;JobList{}</text><g stroke-linecap="round"><path d="M330.267 240.974h238v39h-238" stroke-width="0" fill="#f2ffff"></path><path d="M330.267 240.974h238m-238 0h238m0 0v39m0-39v39m0 0h-238m238 0h-238m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(335.267 250.874)">{&quot;batch&quot;,&quot;v1&quot;,&quot;JobList&quot;}</text><g stroke-linecap="round"><path d="M568.659 187.773h104v39h-104" stroke-width="0" fill="#f2ffff"></path><path d="M568.659 187.773h104m-104 0h104m0 0v39m0-39v39m0 0h-104m104 0h-104m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text x="46.875" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(573.784 197.673)">&amp;PodList{}</text><g stroke-linecap="round"><path d="M330.267 187.692h238v39h-238" stroke-width="0" fill="#f2ffff"></path><path d="M330.267 187.692h238m-238 0h238m0 0v39m0-39v39m0 0h-238m238 0h-238m0 0v-39m0 39v-39" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(335.267 197.592)">{&quot;&quot;,&quot;v1&quot;,&quot;PodList&quot;}</text><text x="8.203" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(135.067 81.076)">.</text><text x="8.203" y="33.6" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(135.067 81.076)">.</text><text x="8.203" y="67.2" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(135.067 81.076)">.</text><text x="8.203" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(484.852 81.076)">.</text><text x="8.203" y="33.6" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(484.852 81.076)">.</text><text x="8.203" y="67.2" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(484.852 81.076)">.</text><text x="8.203" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(979.774 81.076)">.</text><text x="8.203" y="33.6" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(979.774 81.076)">.</text><text x="8.203" y="67.2" font-family="Cascadia, Segoe UI Emoji" font-size="28" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(979.774 81.076)">.</text><g stroke-linecap="round"><path d="M565.417 503.966h148v111h-148" stroke-width="0" fill="#f9f7ed"></path><path d="M565.417 503.966h148m-148 0h148m0 0v111m0-111v111m0 0h-148m148 0h-148m0 0v-111m0 111v-111" stroke="#000" fill="none"></path></g><text x="28.125" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(611.292 508.966)">scheme</text><g stroke-linecap="round"><path d="M590.473 541.472s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.43-1.65 2.86-3.29 5.25-6.04m-5.25 6.04 5.25-6.04m-4.86 11.68c2.13-2.44 4.25-4.88 10.5-12.07m-10.5 12.07c2.3-2.64 4.6-5.29 10.5-12.07m-10.1 17.71c3.1-3.56 6.19-7.12 15.09-17.35m-15.09 17.35c5.09-5.86 10.19-11.72 15.09-17.35m-10.11 17.71c3.85-4.41 7.69-8.83 15.75-18.11m-15.75 18.11c3.31-3.79 6.61-7.59 15.75-18.11m-10.1 17.72c4.14-4.76 8.28-9.53 15.09-17.36m-15.09 17.36c3.35-3.86 6.71-7.72 15.09-17.36m-10.11 17.72c4.8-5.52 9.59-11.03 15.75-18.11m-15.75 18.11 15.75-18.11m-10.1 17.71c3.75-4.31 7.51-8.63 15.09-17.35m-15.09 17.35c5.93-6.82 11.87-13.65 15.09-17.35m-10.11 17.72c6.08-6.99 12.15-13.98 15.75-18.12m-15.75 18.12c3.64-4.19 7.27-8.37 15.75-18.12m-10.1 17.72c2.93-3.37 5.86-6.75 13.78-15.85m-13.78 15.85c3.52-4.05 7.04-8.1 13.78-15.85m-8.79 16.21c2.79-3.22 5.59-6.43 9.18-10.57m-9.18 10.57c2.03-2.34 4.07-4.69 9.18-10.57m-3.54 10.18c1.2-1.39 2.4-2.77 3.28-3.78m-3.28 3.78c.82-.94 1.63-1.88 3.28-3.78" stroke="#f9f7ed" stroke-width="0.5" fill="none"></path><path d="M590.473 541.472h44.84m-44.84 0h44.84m0 0v17.34m0-17.34v17.34m0 0h-44.84m44.84 0h-44.84m0 0v-17.34m0 17.34v-17.34" stroke="#000" fill="none"></path></g><g stroke-linecap="round"><path d="M635.242 541.472s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.73-1.99 3.45-3.98 5.25-6.04m-5.25 6.04c1.38-1.59 2.76-3.18 5.25-6.04m-4.86 11.68c4.18-4.8 8.35-9.6 10.5-12.07m-10.5 12.07c2.12-2.43 4.23-4.86 10.5-12.07m-10.1 17.71c3.24-3.73 6.48-7.46 15.09-17.35m-15.09 17.35c5.83-6.7 11.65-13.41 15.09-17.35m-10.11 17.71c4.76-5.47 9.52-10.95 15.75-18.11m-15.75 18.11c3.7-4.24 7.39-8.49 15.75-18.11m-10.1 17.72 15.09-17.36m-15.09 17.36 15.09-17.36m-10.11 17.72c3.85-4.43 7.7-8.85 15.75-18.11m-15.75 18.11c6.29-7.23 12.57-14.46 15.75-18.11m-10.1 17.71c5.79-6.65 11.57-13.31 15.09-17.35m-15.09 17.35c4.39-5.04 8.77-10.09 15.09-17.35m-10.11 17.72 15.75-18.12m-15.75 18.12c4.49-5.16 8.97-10.32 15.75-18.12m-10.1 17.72c3.26-3.75 6.53-7.51 15.09-17.36m-15.09 17.36c3.04-3.5 6.08-7 15.09-17.36m-10.1 17.72c5.61-6.46 11.22-12.91 15.74-18.11m-15.74 18.11c4.96-5.71 9.93-11.43 15.74-18.11m-10.1 17.72c4.47-5.15 8.94-10.29 13.12-15.1m-13.12 15.1c5.18-5.97 10.37-11.94 13.12-15.1m-8.13 15.46c2.93-3.39 5.87-6.77 7.87-9.06m-7.87 9.06c2.75-3.17 5.51-6.35 7.87-9.06" stroke="#f9f7ed" stroke-width="0.5" fill="none"></path><path d="M635.242 541.472h53.14m-53.14 0h53.14m0 0v17.31m0-17.31v17.31m0 0h-53.14m53.14 0h-53.14m0 0v-17.31m0 17.31v-17.31" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="15.359" fill="#5f3dc4" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(599.374 541.472)">gvk</text><text font-family="Cascadia, Segoe UI Emoji" font-size="15.359" fill="#0a11d3" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(643.596 541.472)">type</text><g stroke-linecap="round"><path d="M590.45 558.592s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.43-1.65 2.86-3.29 5.25-6.04m-5.25 6.04 5.25-6.04m-4.86 11.68c2.13-2.44 4.25-4.88 10.5-12.07m-10.5 12.07c2.3-2.64 4.6-5.29 10.5-12.07m-9.45 16.96c2.97-3.41 5.93-6.82 14.44-16.6m-14.44 16.6c4.88-5.61 9.75-11.21 14.44-16.6m-8.79 16.2c3.52-4.05 7.04-8.09 14.43-16.6m-14.43 16.6c3.02-3.48 6.05-6.96 14.43-16.6m-9.45 16.96c3.97-4.55 7.93-9.11 14.44-16.6m-14.44 16.6c3.21-3.69 6.43-7.38 14.44-16.6m-8.79 16.21c4.39-5.06 8.79-10.11 14.43-16.6m-14.43 16.6c4.46-5.14 8.93-10.27 14.43-16.6m-9.45 16.96c3.6-4.13 7.19-8.26 14.44-16.6m-14.44 16.6 14.44-16.6m-8.79 16.21c5.56-6.41 11.13-12.81 14.43-16.61m-14.43 16.61c3.33-3.84 6.66-7.67 14.43-16.61m-9.45 16.97 13.13-15.1m-13.13 15.1c3.36-3.86 6.71-7.72 13.13-15.1m-7.48 14.7c2.39-2.76 4.79-5.52 7.87-9.06m-7.87 9.06c1.74-2.01 3.49-4.02 7.87-9.06" stroke="#f9f7ed" stroke-width="0.5" fill="none"></path><path d="M590.45 558.592h44.84m-44.84 0h44.84m0 0v15.24m0-15.24v15.24m0 0h-44.84m44.84 0h-44.84m0 0v-15.24m0 15.24v-15.24" stroke="#000" fill="none"></path></g><g stroke-linecap="round"><path d="M635.218 558.592s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.73-1.99 3.45-3.98 5.25-6.04m-5.25 6.04c1.38-1.59 2.76-3.18 5.25-6.04m-4.86 11.68c4.18-4.8 8.35-9.6 10.5-12.07m-10.5 12.07c2.12-2.43 4.23-4.86 10.5-12.07m-9.45 16.96c3.11-3.57 6.21-7.14 14.44-16.6m-14.44 16.6c5.58-6.41 11.15-12.83 14.44-16.6m-8.79 16.2c4.36-5.01 8.72-10.03 14.43-16.6m-14.43 16.6c3.38-3.89 6.77-7.78 14.43-16.6m-9.45 16.96c4.97-5.71 9.94-11.42 14.44-16.6m-14.44 16.6c5.72-6.58 11.44-13.16 14.44-16.6m-8.79 16.21c3.52-4.06 7.05-8.12 14.43-16.6m-14.43 16.6c5.76-6.63 11.52-13.25 14.43-16.6m-9.45 16.96c5.54-6.37 11.08-12.74 14.44-16.6m-14.44 16.6c4.2-4.83 8.4-9.66 14.44-16.6m-8.79 16.21c3.95-4.55 7.9-9.1 14.43-16.61m-14.43 16.61c4.1-4.73 8.21-9.46 14.43-16.61m-9.45 16.97 14.44-16.61m-14.44 16.61c2.92-3.35 5.83-6.7 14.44-16.61m-8.79 16.21c5.14-5.92 10.29-11.84 14.43-16.6m-14.43 16.6c4.55-5.24 9.1-10.47 14.43-16.6m-9.45 16.96c4.25-4.89 8.5-9.77 12.47-14.34m-12.47 14.34 12.47-14.34m-6.82 13.95 6.56-7.55m-6.56 7.55c2.29-2.65 4.59-5.29 6.56-7.55" stroke="#f9f7ed" stroke-width="0.5" fill="none"></path><path d="M635.218 558.592h53.14m-53.14 0h53.14m0 0v15.26m0-15.26v15.26m0 0h-53.14m53.14 0h-53.14m0 0v-15.26m0 15.26v-15.26" stroke="#000" fill="none"></path></g><g stroke-linecap="round"><path d="M590.45 574.313s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.43-1.65 2.86-3.29 5.25-6.04m-5.25 6.04 5.25-6.04m-4.86 11.68c2.13-2.44 4.25-4.88 10.5-12.07m-10.5 12.07c2.3-2.64 4.6-5.29 10.5-12.07m-8.13 15.45c2.69-3.1 5.38-6.2 13.12-15.09m-13.12 15.09c4.43-5.1 8.86-10.19 13.12-15.09m-8.14 15.45c3.36-3.87 6.72-7.73 13.78-15.85m-13.78 15.85c2.89-3.32 5.78-6.65 13.78-15.85m-8.13 15.46c3.6-4.15 7.2-8.29 13.12-15.1m-13.12 15.1c2.91-3.36 5.83-6.72 13.12-15.1m-8.14 15.46c4.2-4.83 8.39-9.66 13.78-15.85m-13.78 15.85c4.26-4.91 8.53-9.81 13.78-15.85m-8.13 15.45c3.26-3.76 6.53-7.51 13.12-15.09m-13.12 15.09c5.16-5.94 10.32-11.87 13.12-15.09m-8.14 15.45c5.32-6.11 10.63-12.22 13.78-15.85m-13.78 15.85c3.18-3.66 6.36-7.32 13.78-15.85m-8.13 15.46c2.51-2.9 5.02-5.79 11.81-13.59m-11.81 13.59c3.01-3.47 6.03-6.95 11.81-13.59m-6.83 13.95c2.2-2.53 4.4-5.06 7.22-8.31m-7.22 8.31c1.6-1.85 3.21-3.69 7.22-8.31" stroke="#f9f7ed" stroke-width="0.5" fill="none"></path><path d="M590.45 574.313h44.84m-44.84 0h44.84m0 0v13.67m0-13.67v13.67m0 0h-44.84m44.84 0h-44.84m0 0v-13.67m0 13.67v-13.67" stroke="#000" fill="none"></path></g><g stroke-linecap="round"><path d="M635.242 574.313s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.73-1.99 3.45-3.98 5.25-6.04m-5.25 6.04c1.38-1.59 2.76-3.18 5.25-6.04m-4.86 11.68c4.18-4.8 8.35-9.6 10.5-12.07m-10.5 12.07c2.12-2.43 4.23-4.86 10.5-12.07m-8.13 15.45c2.82-3.24 5.64-6.49 13.12-15.09m-13.12 15.09c5.06-5.83 10.13-11.66 13.12-15.09m-8.14 15.45c4.17-4.79 8.33-9.58 13.78-15.85m-13.78 15.85c3.23-3.72 6.47-7.43 13.78-15.85m-8.13 15.46c4.51-5.2 9.02-10.39 13.12-15.1m-13.12 15.1c5.2-5.99 10.4-11.97 13.12-15.1m-8.14 15.46c3.37-3.88 6.74-7.75 13.78-15.85m-13.78 15.85c5.5-6.33 11-12.65 13.78-15.85m-8.13 15.45c5.03-5.79 10.06-11.58 13.12-15.09m-13.12 15.09c3.81-4.39 7.63-8.78 13.12-15.09m-8.14 15.45c3.78-4.34 7.55-8.68 13.78-15.85m-13.78 15.85c3.92-4.51 7.85-9.02 13.78-15.85m-8.13 15.46c2.83-3.27 5.67-6.53 13.12-15.1m-13.12 15.1c2.64-3.05 5.29-6.09 13.12-15.1m-8.14 15.46c4.91-5.65 9.83-11.3 13.78-15.85m-13.78 15.85c4.35-5 8.7-10 13.78-15.85m-8.13 15.45c3.8-4.37 7.6-8.74 11.15-12.83m-11.15 12.83c4.4-5.07 8.81-10.14 11.15-12.83m-6.17 13.19c2.21-2.53 4.41-5.07 5.91-6.79m-5.91 6.79c2.07-2.38 4.14-4.75 5.91-6.79" stroke="#f9f7ed" stroke-width="0.5" fill="none"></path><path d="M635.242 574.313h53.14m-53.14 0h53.14m0 0v13.63m0-13.63v13.63m0 0h-53.14m53.14 0h-53.14m0 0v-13.63m0 13.63v-13.63" stroke="#000" fill="none"></path></g><text x="14.063" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(597.494 567.803)">...</text><text x="14.063" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(646.505 567.69)">...</text><g stroke-linecap="round"><path d="M167.837 288.803v287.81m0 0c94.85.49 189.71.98 418.6 2.16" stroke="#000" stroke-width="1.5" fill="none" stroke-dasharray="8 9"></path><path d="m586.437 578.773-13.63 6.27.06-12.68 13.57 6.41" stroke-width="0" fill-rule="evenodd"></path><path d="M586.437 578.773c-5.4 2.48-10.79 4.96-13.63 6.27m0 0c.01-2.87.03-5.75.06-12.68m0 0c3.55 1.67 7.09 3.35 13.57 6.41m0 0s0 0 0 0" stroke="#000" stroke-width="1.5" fill="none"></path></g><g stroke-linecap="round"><path d="M503.313 287.636v276.49m0 0c20.16.25 40.32.51 83.43 1.06" stroke="#000" stroke-width="1.5" fill="none" stroke-dasharray="8 9"></path><path d="m586.743 565.186-13.68 6.17.17-12.68 13.51 6.51" stroke-width="0" fill-rule="evenodd"></path><path d="M586.743 565.186c-3.65 1.65-7.31 3.3-13.68 6.17m0 0c.04-3.07.08-6.13.17-12.68m0 0c3.36 1.62 6.72 3.24 13.51 6.51m0 0s0 0 0 0" stroke="#000" stroke-width="1.5" fill="none"></path></g><g stroke-linecap="round"><path d="M992.832 289.436v303.22m0 0-282.59.9" stroke="#000" stroke-width="1.5" fill="none" stroke-dasharray="8 9"></path><path d="m710.242 593.556 13.58-6.39.04 12.68-13.62-6.29" stroke-width="0" fill-rule="evenodd"></path><path d="M710.242 593.556c5.1-2.4 10.19-4.8 13.58-6.39m0 0c.01 2.82.01 5.64.04 12.68m0 0c-2.96-1.37-5.92-2.74-13.62-6.29m0 0s0 0 0 0" stroke="#000" stroke-width="1.5" fill="none"></path></g><g stroke-linecap="round"><path d="M635.628 615.966c0 25.3 0 50.59.01 105.43m-.01-105.43c0 41.16 0 82.31.01 105.43" stroke="#000" fill="none"></path><path d="m635.638 721.396-6.34-13.59h12.67l-6.33 13.59" stroke-width="0" fill-rule="evenodd"></path><path d="M635.638 721.396c-1.53-3.26-3.05-6.52-6.34-13.59m6.34 13.59c-2.48-5.3-4.95-10.61-6.34-13.59m0 0h12.67m-12.67 0h12.67m0 0c-2.5 5.38-5.01 10.76-6.33 13.59m6.33-13.59c-1.35 2.89-2.7 5.79-6.33 13.59m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(177.563 549.62)">register</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(889.47 561.587)">register</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(456.45 398.304)">register</text><g stroke-linecap="round"><path d="M353.213 749.44h187.54m-187.54 0h187.54" stroke="#000" stroke-width="2" fill="none"></path><path d="m540.753 749.44-13.59 6.34V743.1l13.59 6.34" stroke-width="0" fill-rule="evenodd"></path><path d="M540.753 749.44c-3.35 1.56-6.69 3.12-13.59 6.34m13.59-6.34c-2.76 1.29-5.52 2.57-13.59 6.34m0 0V743.1m0 12.68V743.1m0 0c4.69 2.19 9.39 4.38 13.59 6.34m-13.59-6.34c5.17 2.41 10.34 4.82 13.59 6.34m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><path d="M736.009 749.322h187.4m-187.4 0h187.4" stroke="#000" stroke-width="2" fill="none"></path><path d="m923.409 749.322-13.59 6.34v-12.68l13.59 6.34" stroke-width="0" fill-rule="evenodd"></path><path d="M923.409 749.322c-3.38 1.58-6.76 3.16-13.59 6.34m13.59-6.34c-5.19 2.42-10.39 4.85-13.59 6.34m0 0v-12.68m0 12.68v-12.68m0 0 13.59 6.34m-13.59-6.34c4.68 2.18 9.36 4.36 13.59 6.34m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#000" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><path d="M386.252 732.648h131v32h-131" stroke-width="0" fill="#ced4da"></path><path d="M386.252 732.648h131m-131 0h131m0 0v32m0-32v32m0 0h-131m131 0h-131m0 0v-32m0 32v-32" stroke="#000" fill="none"></path></g><text x="56.25" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(395.502 739.048)">pod([]bytes)</text><g stroke-linecap="round"><path d="M749.46 732.596h131v32h-131" stroke-width="0" fill="#ced4da"></path><path d="M749.46 732.596h131m-131 0h131m0 0v32m0-32v32m0 0h-131m131 0h-131m0 0v-32m0 32v-32" stroke="#000" fill="none"></path></g><text x="28.125" font-family="Cascadia, Segoe UI Emoji" font-size="16" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(786.834 738.996)">&amp;Pod{}</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="rotate(.025 -650622.153 2433535.684)" stroke-opacity="0.6" fill-opacity="0.6">©Xudong Wang🤖️🎈</text></svg><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>编/解码&quot;注册&quot;机制的历史</div><div class="admonitionContent_S0QG"><p>Kubernetes中编/解码的&quot;注册&quot;机制最早可以追溯到<a href="https://github.com/kubernetes/kubernetes/pull/196" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #196</a>。</p><p>在<a href="https://github.com/kubernetes/kubernetes/pull/196" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #196</a>中，开发者首次将<em>kind</em>直接作为字段嵌入API的JSON Schema<sup id="fnref-8"><a href="#fn-8" class="footnote-ref">8</a></sup>中，这样做的动机在作者看来是：&quot;Make api able to marshal its types correctly&quot;。
在<a href="https://github.com/kubernetes/kubernetes/pull/196" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #196</a>之前，其实<code>kube-apiserver</code>甚至与常见Go的REST HTTP Server并本质区别。对于每个API请求，handler调用<code>json.Unmarshal()/json.Marshal()</code>进行朴素的反序列化/序列化即可。
这种方式的一个缺点是<strong>每个</strong>API的handler都要事先知道此API请求/返回体对应的Go类型，才能调用<code>json.Unmarshal</code>/<code>json.Marshal</code>。
在<a href="https://github.com/kubernetes/kubernetes/pull/196" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #196</a>之后，在对API请求体的序列化/反序列化的处理发生了质的转变。
具体来说，开发者第一次引入了Go类型注册机制：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pkg/api/helper.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> knownTypes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">reflect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Type</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">AddKnownTypes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PodList</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Pod</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReplicationControllerList</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReplicationController</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServiceList</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Status</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddKnownTypes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">types </span><span class="token operator" style="color:#393A34">...</span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> types </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> reflect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TypeOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        knownTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中<code>knownTypes</code>变量用于将类型名称（<code>string</code>）映射到具体的反射类型（<code>reflect.Type</code>）。同时在<code>init()</code>函数中，将所有API的Go类型注册进<code>knownTypes</code>这张表中。
这么做的好处是，对于任意的HTTP请求，我们可以通过一个<strong>统一</strong>的解码函数来处理请求体的JSON字节序列（<code>[]byte</code>）的反序列化：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pkg/api/helper.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    findKind </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Kind </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;kind,omitempty&quot; yaml:&quot;kind,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// yaml is a superset of json, so we use it to decode here. That way, we understand both.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> yaml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unmarshal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">findKind</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Errorf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Couldn&#x27;t get kind: %#v&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> found </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> knownTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">findKind</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Kind</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">found </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Errorf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%v is not a known type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> findKind</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Kind</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    obj </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> reflect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">New</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Interface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    err </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> yaml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unmarshal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jsonBase</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nameAndJSONBase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Don&#x27;t leave these set. Track type with go&#x27;s type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jsonBase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Kind </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这个解码函数的逻辑非常简单清晰，首先捕获字节序列<code>data</code>的<code>kind</code>字段，获取类型信息以后，然后在<code>knownTypes</code>表中里直接查找到对应的Go类型，最后调用<code>json.Unmarshal()</code>完成反序列化工作即可。</p><p><code>knownTypes</code>正是后来<code>runtime.Scheme</code>类型的前身。彼时，甚至<em>资源</em>的概念还未在社区形成，API分组并不存在，<code>apiVersion</code>字段也没有引入API的JSON Schema。
因此，相比于现在Kubernetes使用完整的GVK信息映射到具体的Go类型， 当时<code>knownTypes</code>的映射关系十分朴素：<code>kind</code>直接到Go类型。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="小结">小结<a href="#小结" class="hash-link" aria-label="Direct link to 小结" title="Direct link to 小结">​</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小结</div><div class="admonitionContent_S0QG"><p>至此，从kind与<code>runtime.Object</code>的关系，从序列化器与<code>runtime.Scheme</code>关系，从<code>runtime.Scheme</code>与<code>runtime.Object</code>的关系，
我们的论述形成了逻辑闭环——我们从源码的角度阐述了&quot;在Kubernetes中，任何需要序列化/反序列化的Go类型统称为<em>kind</em>&quot;。</p></div></div><div class="footnotes"><hr><ol><li id="fn-1">本文中所出现的<code>runtime</code>指<code>apimachinery</code>库下<code>runtime</code>包。<a href="#fnref-1" class="footnote-backref">↩</a></li><li id="fn-2">本文中所出现的<code>metav1</code>指<code>apimachinery</code>库<code>meta</code>包的<code>v1</code>子包。<a href="#fnref-2" class="footnote-backref">↩</a></li><li id="fn-3">在后续<a href="/crd-controller-from-scratch/docs/apimachinery/serializer">序列化器与序列化器工厂</a>小节我们还会对<code>apimachinery</code>中的序列化器做进一步介绍。<a href="#fnref-3" class="footnote-backref">↩</a></li><li id="fn-4">这里的<em>序列化器</em>并不指代<code>apimachinery</code>库中<strong>某一个具体</strong>的类型，在<code>apimachinery</code>库中有多种行为复杂的序列化器。在本节中，我们用<em>序列化器</em>指代<code>apimachinery</code>库中各种序列化器的一般行为。<a href="#fnref-4" class="footnote-backref">↩</a></li><li id="fn-5">注意与前文提到的schem<strong><u>a</u></strong>包区分，此处为runtime包下的Schem<strong><u>e</u></strong>类型。<a href="#fnref-5" class="footnote-backref">↩</a></li><li id="fn-6">在不作另外说明的情况下，本书所出现的<code>scheme</code>表示<code>runtime.Scheme</code>类型的实例。<a href="#fnref-6" class="footnote-backref">↩</a></li><li id="fn-7"><code>runtime.Scheme</code>中，不仅仅存在<code>gvkToType</code>这一张映射表，同时，方法<code>AddKnownTypeWithName</code>也不仅仅向一张映射表中插入数据。
我们在这尽量抹去实现上的一些细节，侧重于说明<code>runtime.Scheme</code>的一个重要作用——注册。<a href="#fnref-7" class="footnote-backref">↩</a></li><li id="fn-8">彼时<em>资源</em>的概念甚至还没有正式形成。在Kubernetes早期阶段，官方开发者更倾向于使用术语<em>API对象（API Object）</em>或是<em>API类型（API Type）</em>来指代API的JSON Schema。<em>API对象（API Object）</em>首次出现在<a href="https://github.com/kubernetes/kubernetes/pull/529" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 15"><path style="stroke:none;fill-rule:evenodd;fill:#24292f;fill-opacity:1" d="M7.977 0C3.567 0 0 3.438 0 7.691c0 3.399 2.285 6.278 5.453 7.293.399.079.543-.164.543-.367 0-.18-.016-.789-.016-1.426-2.218.457-2.68-.918-2.68-.918-.355-.89-.882-1.12-.882-1.12-.727-.47.05-.47.05-.47.805.051 1.231.79 1.231.79.711 1.172 1.86.84 2.324.636.063-.496.278-.84.5-1.03-1.77-.18-3.632-.84-3.632-3.798 0-.84.316-1.527.82-2.062-.078-.192-.356-.98.078-2.035 0 0 .676-.204 2.191.789a7.99 7.99 0 0 1 3.989 0c1.52-.993 2.195-.79 2.195-.79.434 1.055.156 1.844.078 2.036.516.535.817 1.222.817 2.062 0 2.957-1.86 3.606-3.645 3.797.293.242.543.7.543 1.426 0 1.031-.012 1.86-.012 2.113 0 .203.145.445.54.367 3.171-1.015 5.453-3.894 5.453-7.293C15.953 3.438 12.374 0 7.976 0Zm0 0"></path></svg> Pull Request #529</a><a href="#fnref-8" class="footnote-backref">↩</a></li></ol></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/crd-controller-from-scratch/docs/apimachinery/gvk"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">GVK</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/crd-controller-from-scratch/docs/apimachinery/kind-case-study"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">kind案例探究</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#kind与runtimeobject" class="table-of-contents__link toc-highlight">kind与runtime.Object</a><ul><li><a href="#metav1typemeta" class="table-of-contents__link toc-highlight">metav1.TypeMeta</a></li></ul></li><li><a href="#kind的单体种类与metav1object" class="table-of-contents__link toc-highlight">kind的单体种类与metav1.Object</a><ul><li><a href="#metav1objectmeta元类型" class="table-of-contents__link toc-highlight">metav1.ObjectMeta元类型</a></li><li><a href="#集合种类" class="table-of-contents__link toc-highlight">集合种类</a></li></ul></li><li><a href="#初识apimachinery库的序列化器" class="table-of-contents__link toc-highlight">初识apimachinery库的序列化器</a></li><li><a href="#runtimescheme与kind" class="table-of-contents__link toc-highlight">runtime.Scheme与kind</a></li><li><a href="#小结" class="table-of-contents__link toc-highlight">小结</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Xudong Wang, Under license <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a>, Built with Docusaurus.🎈</div></div></div></footer></div>
<script src="/crd-controller-from-scratch/assets/js/runtime~main.56e28771.js"></script>
<script src="/crd-controller-from-scratch/assets/js/main.66bc2718.js"></script>
</body>
</html>