<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-client-go/restclient">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">RESTClient | ã€Šä»é›¶å®ç°Kubernetesè‡ªå®šä¹‰æ§åˆ¶å™¨ã€‹</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://caozhuozi.github.io/crd-controller-from-scratch/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://caozhuozi.github.io/crd-controller-from-scratch/img/logo.png"><meta data-rh="true" property="og:url" content="https://caozhuozi.github.io/crd-controller-from-scratch/docs/client-go/restclient"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="RESTClient | ã€Šä»é›¶å®ç°Kubernetesè‡ªå®šä¹‰æ§åˆ¶å™¨ã€‹"><meta data-rh="true" name="description" content="æœ¬èŠ‚çš„åŠ¨æœºä¸æˆ‘ä»¬åœ¨client-goä¸apimachineryä¸€æ ·ï¼Œ"><meta data-rh="true" property="og:description" content="æœ¬èŠ‚çš„åŠ¨æœºä¸æˆ‘ä»¬åœ¨client-goä¸apimachineryä¸€æ ·ï¼Œ"><link data-rh="true" rel="icon" href="/crd-controller-from-scratch/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/client-go/restclient"><link data-rh="true" rel="alternate" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/client-go/restclient" hreflang="en"><link data-rh="true" rel="alternate" href="https://caozhuozi.github.io/crd-controller-from-scratch/docs/client-go/restclient" hreflang="x-default"><link rel="stylesheet" href="/crd-controller-from-scratch/assets/css/styles.37df9119.css">
<link rel="preload" href="/crd-controller-from-scratch/assets/js/runtime~main.56e28771.js" as="script">
<link rel="preload" href="/crd-controller-from-scratch/assets/js/main.66bc2718.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#e6f6e6;color:#5f805b" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">ğŸ¥³v0.6.0-rc2 is released.ğŸ‰</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/crd-controller-from-scratch/"><div class="navbar__logo"><img src="/crd-controller-from-scratch/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/crd-controller-from-scratch/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/crd-controller-from-scratch/docs/intro">å¼€å§‹</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/caozhuozi/crd-controller-from-scratch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/crd-controller-from-scratch/docs/intro">å‰è¨€</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/crd-controller-from-scratch/docs/apimachinery/apimachinery">apimachinery</a><button aria-label="Toggle the collapsible sidebar category &#x27;apimachinery&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/crd-controller-from-scratch/docs/client-go/client-go">client-go</a><button aria-label="Toggle the collapsible sidebar category &#x27;client-go&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/crd-controller-from-scratch/docs/client-go/restclient">RESTClient</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/client-go/controller">Controller</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/client-go/informer-is-all-you-need">informer is all you need</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/crd-controller-from-scratch/docs/client-go/summary">æœ¬ç« å°ç»“</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/crd-controller-from-scratch/docs/putting-it-all-together/putting-it-all-together">putting it all together</a><button aria-label="Toggle the collapsible sidebar category &#x27;putting it all together&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/crd-controller-from-scratch/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/crd-controller-from-scratch/docs/client-go/client-go"><span itemprop="name">client-go</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">RESTClient</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>RESTClient</h1><p>æœ¬èŠ‚çš„åŠ¨æœºä¸æˆ‘ä»¬åœ¨<a href="/crd-controller-from-scratch/docs/apimachinery/client-go-and-apimachinery">client-goä¸apimachinery</a>ä¸€æ ·ï¼Œ
<code>client-go</code>ä¸­å°è£…åŸå®Œå¤‡èµ„æºå®¢æˆ·ç«¯<code>clientset</code>ä»…é’ˆå¯¹åŸç”Ÿçš„Kubernetesèµ„æºç±»å‹ã€‚
æˆ‘ä»¬éœ€è¦æ¢ç©¶<code>client-go</code>èƒŒåä¸<code>kube-apiserver</code>é€šä¿¡çš„ç»†èŠ‚ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½&quot;ç…§çŒ«ç”»è™&quot;â€”â€”å®ç°ä¸€ä¸ªé’ˆå¯¹<em>è‡ªå®šä¹‰èµ„æº</em>çš„å®¢æˆ·ç«¯ã€‚
<code>client-go</code>ä¸­çš„<code>RESTClient</code>å°±æ˜¯èƒŒåç»†èŠ‚çš„ä¸€éƒ¨åˆ†ã€‚</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>æ³¨</div><div class="admonitionContent_S0QG"><p>å½“ç„¶ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨<a href="/crd-controller-from-scratch/docs/apimachinery/gvk">GVK</a>å°èŠ‚å°±å·²ç»æåŠè¿‡çš„ä¸€æ ·ï¼Œç†è®ºä¸Šï¼Œåªè¦æˆ‘ä»¬æœ‰ä¸<code>kube-apiserver</code>è¿›è¡ŒTLSåŠ å¯†é€šä¿¡çš„è¯ä¹¦å’Œå¯†é’¥ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸å€ŸåŠ©<code>client-go</code>è€Œä½¿ç”¨å…¶ä»–ä»»ä½•è¯­è¨€ä¸<code>kube-apiserver</code>äº¤äº’ã€‚
ä¸è¿‡ï¼Œè¿™äº›å†…å®¹ä¸åœ¨æœ¬ä¹¦çš„è®¨è®ºèŒƒå›´ä¹‹å†…ã€‚æœ¬ä¹¦çš„ä¸»æ—¨æ˜¯å¸®åŠ©è¯»è€…ç†è§£kubebuilderç­‰æ§åˆ¶å™¨æ¡†æ¶èƒŒåçš„æœºåˆ¶ã€‚æ­£å› ä¸ºè¿™äº›æ¡†æ¶æœ¬èº«åŸºäº<code>client-go</code>å’Œ<code>apimachinery</code>åº“æ„å»ºï¼Œ
æ¢ç©¶è¿™ä¸¤ä¸ªåº“èƒŒåçš„ç»†èŠ‚ä¹Ÿæˆä¸ºæˆ‘ä»¬å¿…é¡»è¦ç»å†çš„è¿‡ç¨‹ã€‚</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="clientsetä¸restclient">Clientsetä¸RESTClient<a href="#clientsetä¸restclient" class="hash-link" aria-label="Direct link to Clientsetä¸RESTClient" title="Direct link to Clientsetä¸RESTClient">â€‹</a></h2><p>åœ¨<a href="/crd-controller-from-scratch/docs/intro">å‰è¨€</a>ä¸­ï¼Œæˆ‘ä»¬è¦æ±‚é˜…è¯»æœ¬ä¹¦éœ€è¦æŒæ¡çš„é¢„å¤‡çŸ¥è¯†åŒ…æ‹¬ä¼šä½¿ç”¨<code>client-go</code>ä¸­çš„<code>Clientset</code>ã€‚<code>Clientset</code>é¡¾åæ€ä¹‰æ˜¯Kubernetesæ‰€æœ‰<strong>å†…ç½®</strong>èµ„æºç±»å‹çš„å®¢æˆ·ç«¯çš„<strong>é›†åˆ</strong>ï¼Œæ­£å¦‚å®ƒçš„å®šä¹‰ä¸€æ ·ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/kubernetes/clientset.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Clientset </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    appsV1                       </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">appsv1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppsV1Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    appsV1beta1                  </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">appsv1beta1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppsV1beta1Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    appsV1beta2                  </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">appsv1beta2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppsV1beta2Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>Clientset</code>åŒ…å«äº†æ‰€æœ‰å†…ç½®APIåˆ†ç»„ï¼ˆåŠç‰ˆæœ¬ï¼‰<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>çš„å®¢æˆ·ç«¯ã€‚
è¯·æ³¨æ„ï¼Œæ ¹æ®å…¶ä¸­æ¯ä¸ªå®¢æˆ·ç«¯çš„å‘½åï¼Œ<strong>æ¯ä¸ªå®¢æˆ·ç«¯å…¶å®çš„å¯¹åº”çš„æ˜¯ä¸€ä¸ªAPIç»„ï¼Œè€Œå¹¶ä¸æ˜¯å…·ä½“åˆ°æŸä¸€ç§èµ„æºç±»å‹</strong>ã€‚</p><p>æˆ‘ä»¬å†ç¨å¾®æ·±å…¥æ¢ç©¶ä¸€ä¸‹æ¯ä¸ª<em>APIç»„å®¢æˆ·ç«¯</em>çš„ç±»å‹ï¼Œä¾‹å¦‚<code>appsv1.AppsV1Client</code>ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/kubernetes/typed/apps/v1/apps_client.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> AppsV1Client </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restClient rest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å…¶ä¸­<code>rest.Interface</code><sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>æ˜¯ä¸€ä¸ªè¡¨è¾¾HTTP RESTFulåŠ¨è¯çš„é€šç”¨æ¥å£ï¼Œæ­£å¦‚å®ƒçš„å®šä¹‰ä¸€æ ·ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/rest/client.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Interface </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetRateLimiter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> flowcontrol</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RateLimiter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Verb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">verb </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Request</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Request</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Request</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pt types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PatchType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Request</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Request</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Delete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">APIVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GroupVersion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>åœ¨<code>client-go</code>ä¸­ï¼Œ<code>RESTClient</code>æ˜¯<code>rest.Interface</code>æ¥å£çš„æ ‡å‡†å®ç°ã€‚
æ‰€ä»¥ï¼ŒAPIç»„å®¢æˆ·ç«¯å®é™…ä¸Šæ˜¯å¯¹<code>client-go</code>ä¸­æ›´ä¸ºåŸºç¡€çš„RESTfulå®¢æˆ·ç«¯ç»„ä»¶<code>RESTClient</code>çš„ä¸€ç§å°è£…ã€‚</p><p>åœ¨äº†è§£äº†è¿™ä¸ªäº‹å®ä¹‹åï¼Œæˆ‘ä»¬è‡ªç„¶è€Œç„¶åœ°çŒœæµ‹<code>RESTClient</code>ç±»å‹æœ¬èº«åˆå§‹åŒ–çš„&quot;ç²’åº¦&quot;å¯èƒ½å°±æ˜¯GVã€‚é‚£ä¹ˆäº‹å®æ˜¯å¦ä¹Ÿæ˜¯è¿™æ ·å‘¢ï¼Ÿ
æ ¹æ®<code>RESTClient</code>çš„åˆå§‹åŒ–å‡½æ•°çš„ç­¾åï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">client-go/rest/config.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RESTClientFor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">RESTClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>rest.Config</code>ç»“æ„è¢«ç”¨äºé…ç½®åŠåˆå§‹åŒ–<code>RESTClient</code>ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç¨å¾®æ¢ç©¶ä¸€ä¸‹<code>rest.Config</code>ç±»å‹ã€‚
<code>rest.Config</code>åˆåµŒå…¥äº†ä¸€ä¸ªå«åš<code>ContentConfig</code>çš„ç»“æ„ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/rest/config.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Config </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ContentConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è€Œæ ¹æ®<code>ContentConfig</code>ç»“æ„çš„å®šä¹‰ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/rest/config.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> ContentConfig </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  GroupVersion </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GroupVersion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å…¶ä¸­<code>GroupVersion</code>æˆå‘˜è¯´æ˜äº†<code>ContentConfig</code>ç»“æ„çš„&quot;ç²’åº¦&quot;æ­£æ˜¯GVã€‚å› æ­¤ï¼Œ<code>RESTClient</code>ç±»å‹çš„ç²’åº¦ä¹Ÿå¯ä»¥è¢«è¯å®ä¸ºGVã€‚</p><p>ä¸‹å›¾æ€»ç»“äº†<code>RESTClient</code>çš„åˆå§‹åŒ–å‡½æ•°<code>RESTClientFor()</code>çš„&quot;é…ç½®é“¾&quot;çš„å…³ç³»ï¼š</p><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1279.754 179.444" width="1279.754" height="179.444" style="width:100%"><defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><g stroke-opacity="0.3" fill-opacity="0.3" stroke-linecap="round"><path d="M510.235 13.724h302v129h-302" stroke-width="0" fill="#ced4da"></path><path d="M510.235 13.724h302m-302 0h302m0 0v129m0-129v129m0 0h-302m302 0h-302m0 0v-129m0 129v-129" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(515.235 18.724)" stroke-opacity="0.3" fill-opacity="0.3">k8s.io/client-go/rest/config.go</text><g stroke-opacity="0.5" fill-opacity="0.5"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(524.605 51.171)">type Config struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(524.605 51.171)"></text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(524.605 51.171)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(524.605 51.171)">}</text></g><g stroke-opacity="0.3" fill-opacity="0.3" stroke-linecap="round"><path d="M897.718 10h370v129h-370" stroke-width="0" fill="#ced4da"></path><path d="M897.718 10h370m-370 0h370m0 0v129m0-129v129m0 0h-370m370 0h-370m0 0V10m0 129V10" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(902.718 15)" stroke-opacity="0.3" fill-opacity="0.3">k8s.io/client-go/rest/config.go</text><g stroke-opacity="0.5" fill-opacity="0.5"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(912.088 47.447)">type ContentConfig struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(912.088 47.447)"></text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(912.088 47.447)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(912.088 47.447)">}</text></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" fill="#5c940d" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(818.43 56.341)" stroke-opacity="0.7" fill-opacity="0.7">embeded</text><g stroke-linecap="round"><path d="M699.22 84.261h192.69" stroke="#5c940d" stroke-width="2.5" fill="none" stroke-dasharray="1.5 8" stroke-opacity="0.6" fill-opacity="0.6"></path><g stroke-opacity="0.6" fill-opacity="0.6"><path d="m891.91 84.261-13.59 6.34v-12.68l13.59 6.34" stroke-width="0" fill="#5c940d" fill-rule="evenodd"></path><path d="M891.91 84.261c-3.76 1.75-7.52 3.51-13.59 6.34m0 0v-12.68m0 0c3.58 1.67 7.15 3.34 13.59 6.34m0 0s0 0 0 0" stroke="#5c940d" stroke-width="2.5" fill="none"></path></g></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(565.139 70.84)">ContentConfig</text><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(951.208 66.204)">GroupVersion *schema.GroupVersion</text><text font-family="Cascadia, Segoe UI Emoji" font-size="20" style="white-space:pre" dominant-baseline="text-before-edge" transform="rotate(.025 -326220.544 2439358.1)" stroke-opacity="0.6" fill-opacity="0.6">Â©Xudong WangğŸ¤–ï¸ğŸˆ</text><g stroke-opacity="0.3" fill-opacity="0.3" stroke-linecap="round"><path d="M10 15.076h302v129H10" stroke-width="0" fill="#ced4da"></path><path d="M10 15.076h302m-302 0h302m0 0v129m0-129v129m0 0H10m302 0H10m0 0v-129m0 129v-129" stroke="#000" fill="none"></path></g><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(15 20.076)" stroke-opacity="0.3" fill-opacity="0.3">k8s.io/client-go/rest/client.go</text><g stroke-opacity="0.5" fill-opacity="0.5"><text font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(24.37 52.524)">type RESTClient struct {</text><text y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(24.37 52.524)"></text><text y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(24.37 52.524)">    // ...</text><text y="57.6" font-family="Cascadia, Segoe UI Emoji" font-size="16" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(24.37 52.524)">}</text></g><g stroke-linecap="round"><path d="M320.119 75.69h184.87m-184.87 0h184.87" stroke="#1e1e1e" stroke-width="2" fill="none" stroke-opacity="0.8" fill-opacity="0.8"></path><g stroke-opacity="0.8" fill-opacity="0.8"><path d="m320.119 75.69 13.59-6.34v12.68l-13.59-6.34" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M320.119 75.69c3.06-1.43 6.13-2.86 13.59-6.34m-13.59 6.34c2.74-1.28 5.48-2.55 13.59-6.34m0 0v12.68m0-12.68v12.68m0 0c-2.77-1.29-5.55-2.59-13.59-6.34m13.59 6.34c-4.81-2.24-9.62-4.49-13.59-6.34m0 0s0 0 0 0m0 0s0 0 0 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><text x="70.313" font-family="Cascadia, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" dominant-baseline="text-before-edge" transform="translate(339.839 45.804)">RESTClientFor()</text></svg><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>æˆ‘ä»¬ä»<code>clientset</code>çš„è§’åº¦åˆ‡å…¥ï¼Œä»‹ç»äº†<code>client-go</code>ä¸­çš„<em>APIç»„å®¢æˆ·ç«¯</em>ï¼Œ
å†ä»<em>APIç»„å®¢æˆ·ç«¯</em>å¼•å…¥<code>client-go</code>çš„&quot;çœŸæ­£&quot;çš„HTTPå®¢æˆ·ç«¯åŸºç¡€ç»„ä»¶<code>RESTClient</code>ï¼Œæ„åœ¨è¯´æ˜<code>RESTClient</code>åˆå§‹åŒ–&quot;ç²’åº¦&quot;æ˜¯<em>GroupVersion</em>ã€‚</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="restclientåŸºæœ¬ç”¨æ³•">RESTClientåŸºæœ¬ç”¨æ³•<a href="/crd-controller-from-scratch/docs/intro#%E7%BA%A6%E5%AE%9A">ğŸˆ</a><a href="#restclientåŸºæœ¬ç”¨æ³•" class="hash-link" aria-label="Direct link to restclientåŸºæœ¬ç”¨æ³•" title="Direct link to restclientåŸºæœ¬ç”¨æ³•">â€‹</a></h2><p>ä¸‹é¢æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªæä¸ºç®€å•çš„ä¾‹å­æ¥ä»‹ç»å¦‚ä½•ä½¿ç”¨<code>RESTClient</code>ç±»å‹ç›´æ¥ä¸Kubernetes APIäº¤äº’ã€‚</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        corev1 </span><span class="token string" style="color:#e3116c">&quot;k8s.io/api/core/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        metav1 </span><span class="token string" style="color:#e3116c">&quot;k8s.io/apimachinery/pkg/apis/meta/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;k8s.io/client-go/kubernetes/scheme&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;k8s.io/client-go/rest&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;k8s.io/client-go/tools/clientcmd&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> clientcmd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">BuildConfigFromFlags</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/root/.kube/config&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">APIPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/api&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GroupVersion </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">corev1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SchemeGroupVersion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NegotiatedSerializer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scheme</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Codecs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithoutConversion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        restClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> rest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RESTClientFor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">corev1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PodList</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// list</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        restClient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">Namespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;default&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">Resource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;pods&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">Name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;pod&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">VersionedParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ListOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scheme</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ParameterCodec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">Do</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">Into</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ç›´æ¥ä½¿ç”¨RESTClientç±»å‹ä¸Kubernetes APIäº¤äº’ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><ol><li><p>ç¬¬ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯é€šè¿‡<code>rest.Config</code>å¯¹è±¡æ¥åˆå§‹åŒ–ä¸€ä¸ª<code>RESTClient</code>å®ä¾‹ã€‚</p><ul><li><p><code>clientcmd.BuildConfigFromFlags()</code> <sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup>ç”¨äºåˆ›å»ºå¹¶è¿”å›ä¸€ä¸ª<code>rest.Config</code>å¯¹è±¡ï¼ŒåŒæ—¶å°†<code>.kube/config</code>æ–‡ä»¶ä¸­è®°å½•çš„ä¿¡æ¯è½¬åŒ–ä¸º<code>Config</code>å¯¹è±¡ä¸­çš„<code>Host</code>å­—æ®µä»¥åŠç”¨äºä¸<code>kube-apiserver</code>TLSåŠ å¯†é€šä¿¡çš„æœ‰å…³å­—æ®µã€‚</p><img loading="lazy" src="/crd-controller-from-scratch/assets/images/config-outside-69705c57160b6b26d8fd83b47e8515e6.png" width="90%" class="img_ev3q"></li><li><p>è®¾ç½®Kubernetes API URL Pathçš„æ ¹è·¯å¾„, é€šå¸¸ä¸º<code>/apis</code>ï¼Œä½†æ˜¯å¯¹äº<em>æ ¸å¿ƒç»„</em>è¿™ä¸ªAPIåˆ†ç»„æ¥è¯´ï¼Œç”±äºå†å²åŸå› ï¼Œå®ƒå¯¹åº”çš„APIæ ¹è·¯å¾„åˆ™æ˜¯<code>/api</code></p></li><li><p>è®¾ç½®èµ„æºçš„APIåˆ†ç»„åŠç‰ˆæœ¬ä¿¡æ¯â€”â€”æ­£å¦‚æˆ‘ä»¬ä¸ŠèŠ‚è¯å®çš„é‚£æ ·ï¼š<code>RESTClient</code>çš„é…ç½®&quot;ç²’åº¦&quot;æ˜¯GV</p></li><li><p>æŒ‡å®šç”¨äºHTTPè¯·æ±‚ä¸è¿”å›ä½“ç¼–/è§£ç çš„åºåˆ—åŒ–å™¨ï¼š</p><ul><li>æ‰€ç”¨çš„åºåˆ—åŒ–å™¨å·¥å‚<code>scheme.Codecs</code>æ­£æ˜¯ä¹‹å‰<a href="/crd-controller-from-scratch/docs/apimachinery/client-go-and-apimachinery#client-go%E4%B8%AD%E7%9A%84%E5%85%A8%E5%B1%80%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E5%B7%A5%E5%8E%82">client-goä¸­çš„å…¨å±€åºåˆ—åŒ–å™¨å·¥å‚</a>ç« èŠ‚ä¸­æ‰€è¯´çš„å…¨å±€åºåˆ—åŒ–å·¥å‚<code>Codec</code>ã€‚</li><li>å¦å¤–ï¼Œä¸åŒäº<code>kube-apiserver</code>æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯åœ¨å¯¹èµ„æºç¼–ç å‰/è§£ç åä¸éœ€è¦å†é¢å¤–è¿›è¡Œèµ„æºç‰ˆæœ¬é—´çš„è½¬æ¢ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†<code>Codec</code>çš„<code>WithoutConversion()</code>æ–¹æ³•è·å–ä¸è¿›è¡Œèµ„æºç‰ˆæœ¬è½¬åŒ–çš„åºåˆ—åŒ–å™¨ã€‚</li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>æ³¨</div><div class="admonitionContent_S0QG"><p>å¯ä»¥è¯´æˆ‘ä»¬åœ¨<a href="/crd-controller-from-scratch/docs/apimachinery/serializer">åºåˆ—åŒ–å™¨ä¸åºåˆ—åŒ–å·¥å‚</a>ä»¥åŠ<a href="#../apimachinery/client-go-and-apimachinery">client-goä¸apimachinery</a>å°èŠ‚çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯ä¸ºäº†è¿™ä¸€è¡Œä»£ç æ‰€åšçš„é“ºå«ã€‚</p></div></div></li></ul></li></ol><ol start="2"><li>ç¬¬äºŒéƒ¨åˆ†åˆ™æ˜¯è°ƒç”¨<code>RESTClient</code>ç›¸å…³æ–¹æ³•ç”¨äºå®é™…å‘Kubernetes APIå‘èµ·è¯·æ±‚ã€‚
å¯ä»¥çœ‹å‡ºï¼Œ<code>RESTClient</code>å‘é€è¯·æ±‚çš„ä»£ç åŸºäº<em>å»ºé€ è€…æ¨¡å¼ï¼ˆbuilder patternï¼‰</em>ï¼Œå…·ä½“çš„èµ„æºç±»å‹ï¼Œå‘½åç©ºé—´ç­‰æ˜¯åœ¨å‘Kubernetes APIå‘èµ·è¯·æ±‚æ—¶æŒ‡å®šã€‚
ä¸€ä¸ªç¨å¾®ç‰¹æ®Šçš„æ–¹æ³•æ˜¯<code>VersionedParams()</code>ï¼Œå®ƒç”¨äºå°†<code>metav1.ListOptions</code>å¯¹è±¡&quot;è§£ç &quot;ä¸ºHTTP URLä¸­æŸ¥è¯¢å‚æ•°ï¼ˆquery parameterï¼‰ï¼Œå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ç”¨äºæŒ‡å®šè§£ç å™¨ï¼Œè€Œè¿™ä¸ªè§£ç å™¨æ­£æ˜¯ä¹‹å‰<a href="/crd-controller-from-scratch/docs/apimachinery/client-go-and-apimachinery#client-go%E4%B8%AD%E7%9A%84%E5%85%A8%E5%B1%80url%E5%8F%82%E6%95%B0%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8">client-goä¸­çš„å…¨å±€urlå‚æ•°åºåˆ—åŒ–å™¨</a>ç« èŠ‚ä¸­æåŠçš„å…¨å±€URLå‚æ•°åºåˆ—åŒ–å™¨<code>ParameterCodec</code>ã€‚
è¿™äº›å¡«å…¥çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬æ ¹è·¯å¾„ï¼ŒGroupVersionï¼Œèµ„æºç±»å‹ï¼Œå‘½åç©ºé—´ç­‰ï¼‰æœ€ç»ˆå°†è¢«ç”¨äºç»„æˆHTTPè¯·æ±‚çš„URLï¼ˆä»¥åŠURLä¸­çš„æŸ¥è¯¢å‚æ•°ï¼‰ã€‚</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="requestç±»å‹">Requestç±»å‹<a href="#requestç±»å‹" class="hash-link" aria-label="Direct link to Requestç±»å‹" title="Direct link to Requestç±»å‹">â€‹</a></h3><p>æˆ‘ä»¬æœ‰å¿…è¦åœ¨è¿™é‡Œç¨å¾®æåŠä¸€ä¸ªå¯èƒ½è¢«å¿½ç•¥çš„ç»†èŠ‚ã€‚
åœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¯´<code>RESTClient</code>åŸºäºå»ºé€ è€…æ¨¡å¼ã€‚å…¶å®æ›´å‡†ç¡®çš„è¯´æ³•æ˜¯åŸºäºå»ºé€ è€…æ¨¡å¼çš„æ˜¯<code>client-go</code>ä¸­çš„<code>Request</code>ç±»å‹è€Œé<code>RESTClient</code>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å†å›è¿‡å¤´æ¥å…·ä½“çœ‹çœ‹<code>RESTClient</code>çš„æ¥å£<code>rest.Interface</code>ï¼Œå¯ä»¥å‘ç°<code>RESTClient</code>çš„<code>Post()</code>ï¼Œ<code>Get()</code>ï¼Œ<code>Delete()</code>ç­‰æ–¹æ³•å…¶å®è¿”å›æ˜¯<code>Request</code>ç±»å‹ï¼ˆæŒ‡é’ˆï¼‰ï¼Œè€Œä¸æ˜¯<code>RESTClient</code>ç±»å‹è‡ªèº«ã€‚
çœŸæ­£æ‰§è¡Œå‘Kubernetes APIå‘é€è¯·æ±‚åŠ¨ä½œçš„å…¶å®æ˜¯<code>Request</code>ç±»å‹ã€‚
ä¸Šè¿°ä¾‹å­ä¸­çš„<code>Namespace()</code>ï¼Œ<code>Resource()</code>ï¼Œ<code>Name()</code>ï¼Œ<code>VersionedParams()</code>ç­‰æ–¹æ³•å…¶å®æ˜¯<code>Request</code>ç±»å‹çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•è¿”å›çš„ä¹Ÿæ˜¯<code>Request</code>ç±»å‹æœ¬èº«ã€‚æ‰€ä»¥<code>RESTClient</code>çš„é“¾å¼è°ƒç”¨å…¶å®åœ¨èƒŒååŸºäºçš„æ˜¯<code>Request</code>ç±»å‹çš„å»ºé€ è€…æ¨¡å¼ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯<code>Request</code>ç±»å‹åŒ…æ‹¬ä¸€ä¸ªå®Œæ•´çš„<code>RESTClient</code>ç»“æ„ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">client-go/rest/request.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Request </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">RESTClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™å°±æ„å‘³ç€ï¼Œ<code>Request</code>ç»“æ„å°†å¯ä»¥ä½¿ç”¨<code>RESTClient</code>ä¸­æ‰€æºå¸¦çš„é…ç½®åŠç»„ä»¶ä¸Kubernetes APIé€šä¿¡ï¼šä¾‹å¦‚ï¼Œ<strong>åå•†åºåˆ—åŒ–å™¨</strong>ï¼ŒTLSåŠ å¯†é€šä¿¡çš„è¯ä¹¦ç­‰ç­‰ã€‚
æ‰€ä»¥ï¼Œç°åœ¨çœ‹æ¥ï¼Œ<code>RESTClient</code>æ›´åƒæ˜¯ä¸€ä¸ªæºå¸¦å„ç§é…ç½®åŠå·¥å…·çš„&quot;å£³&quot;ï¼Œå®ƒè°ƒç”¨<code>Post()</code>ï¼Œ<code>Get()</code>ï¼Œ<code>Delete()</code>ç­‰æ–¹æ³•å°†è‡ªèº«è½¬åŒ–ä¸º<code>Request</code>ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚</p><p>å¦å¤–ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç»†èŠ‚æ˜¯ï¼Œ<code>Request</code>ç±»å‹çš„<code>Do()</code>æ–¹æ³•åˆ™æœ‰æ‰€ä¸åŒï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªå«åš<code>Result</code>çš„ç±»å‹ã€‚
ä»¥ä¸‹åŠ¨ä½œåœ¨<code>Do()</code>æ–¹æ³•ä¸­å®Œæˆï¼š</p><ul><li>å®é™…å‘Kubernetes APIå‘é€HTTPè¯·æ±‚</li><li>åœ¨æ‹¿åˆ°HTTPè¿”å›åï¼Œ<code>Request</code>ä½¿ç”¨å…¶<code>RESTClient</code>æˆå‘˜ä¸­çš„<strong>åå•†åºåˆ—åŒ–å™¨</strong>å†å°†è¿”å›ä½“ååºåˆ—åŒ–ï¼Œå¹¶è¿›ä¸€æ­¥å°è£…æˆ<code>Result</code>ç±»å‹å¹¶è¿”å›</li></ul><p>æ¢ä¸ªè§’åº¦æ¥è¯´ï¼Œåœ¨<code>Do()</code>ä¹‹å‰æ‰€æœ‰çš„é“¾å¼è°ƒç”¨å…¶å®éƒ½åœ¨ä¸ºç»„è£…å‘å¾€Kubernetes APIçš„HTTPè¯·æ±‚è€Œå‡†å¤‡ã€‚</p><p>ä¸‹å›¾ä»¥<code>Get()</code>æ–¹æ³•ä¸ºä¾‹æ€»ç»“äº†<code>RESTClient</code>çš„é“¾å¼è°ƒç”¨ä¸­å„ç±»å‹ä¹‹é—´çš„å…³ç³»ï¼š</p><img loading="lazy" src="/crd-controller-from-scratch/assets/images/request-417d94e266e157a1a8660e4fd03e1ecd.png" style="width:100%" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="èµ„æºå®¢æˆ·ç«¯">èµ„æºå®¢æˆ·ç«¯<a href="#èµ„æºå®¢æˆ·ç«¯" class="hash-link" aria-label="Direct link to èµ„æºå®¢æˆ·ç«¯" title="Direct link to èµ„æºå®¢æˆ·ç«¯">â€‹</a></h2><p>å…¶å®é™¤äº†<em>APIç»„å®¢æˆ·ç«¯</em>å¤–ï¼Œ<code>client-go</code>ä¸­ä¹Ÿä¸ºæ¯ä¸ªèµ„æºç±»å‹å°è£…äº†ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œä¾‹å¦‚ä¸º<code>pods</code>å°è£…çš„å®¢æˆ·ç«¯ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/kubernetes/typed/core/v1/pod.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> pods </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client rest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ns     </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>pods</code>å®¢æˆ·ç«¯ä¹Ÿæ˜¯å¯¹åŸºç¡€ç»„ä»¶<code>RESTClient</code>çš„å°è£…ï¼Œè€Œä¸”ç›¸æ¯”äºAPIç»„å®¢æˆ·ç«¯ï¼Œå¤šäº†ä¸€ä¸ªæœ‰å…³å‘½åç©ºé—´çš„ï¼ˆnamespaceï¼‰çš„æˆå‘˜å˜é‡ã€‚
å¦å¤–ï¼Œé€šè¿‡å®ƒå¯¹åº”çš„æ¥å£:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> PodInterface </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pod </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CreateOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pod </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UpdateOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">UpdateStatus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pod </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UpdateOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Delete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DeleteOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GetOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ListOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PodList</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Watch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ListOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">watch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pt types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PatchType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PatchOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> subresources </span><span class="token operator" style="color:#393A34">...</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹å‡º<em>èµ„æºå®¢æˆ·ç«¯</em>ä¸ºæŸä¸€èµ„æºç±»å‹çš„å¢åˆ æ”¹æŸ¥éƒ½å°è£…äº†ç›¸åº”çš„æ–¹æ³•ã€‚å¹¶ä¸”åœ¨å®ç°ä¸Šï¼Œå°è£…çš„å„ä¸ªæ–¹æ³•ä¸­å…¶å®éƒ½ä½¿ç”¨äº†<code>RESTClient</code>è¿™ä¸ªåŸºç¡€ç»„ä»¶ï¼Œä¾‹å¦‚podsèµ„æºå®¢æˆ·ç«¯çš„<code>Get()</code>æ–¹æ³•ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/kubernetes/typed/core/v1/pod.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">pods</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GetOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    err </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">Namespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">Resource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;pods&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">Name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">VersionedParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scheme</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ParameterCodec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">Do</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">Into</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>é™¤äº†å¢åˆ æ”¹æŸ¥ä»¥å¤–ï¼Œå…¶ä¸­èµ„æºå®¢æˆ·ç«¯å°è£…çš„<code>Watch()</code>å’Œ<code>UpdateStatus()</code>æ–¹æ³•ä¹Ÿååˆ†é‡è¦ï¼Œæˆ‘ä»¬åœ¨åç»­ç« èŠ‚è¿˜ä¼šä»‹ç»ã€‚
åœ¨è¿™é‡Œï¼Œä½ åªéœ€è¦äº†è§£<code>client-go</code>ä¸ºæ¯ä¸ªèµ„æºç±»å‹ä¹Ÿ<strong>å•ç‹¬</strong>å°è£…äº†ä¸€ä¸ªå®¢æˆ·ç«¯ã€‚</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="client-goä¸­å„å®¢æˆ·ç«¯ç±»å‹ä¹‹é—´çš„å…³ç³»">client-goä¸­å„å®¢æˆ·ç«¯ç±»å‹ä¹‹é—´çš„å…³ç³»<a href="#client-goä¸­å„å®¢æˆ·ç«¯ç±»å‹ä¹‹é—´çš„å…³ç³»" class="hash-link" aria-label="Direct link to client-goä¸­å„å®¢æˆ·ç«¯ç±»å‹ä¹‹é—´çš„å…³ç³»" title="Direct link to client-goä¸­å„å®¢æˆ·ç«¯ç±»å‹ä¹‹é—´çš„å…³ç³»">â€‹</a></h2><p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰ä»‹ç»<em>APIç»„å®¢æˆ·ç«¯</em>ä¸<em>èµ„æºå®¢æˆ·ç«¯</em>çš„å…³ç³»ï¼Œæˆ‘ä»¬åªè¦ç¨å¾®æ¢ç©¶<em>APIç»„å®¢æˆ·ç«¯</em>çš„æ–¹æ³•å°±ä¼šçŸ¥é“å®ƒä»¬ä¹‹é—´çš„å…³ç³»äº†â€”â€”ä¸ºäº†é˜…è¯»ä¸Šçš„è¿è´¯æ€§ï¼Œåœ¨<a href="#clientset%E4%B8%8Erestclient">Clientsetä¸RESTClient</a>å°èŠ‚ä¸­æˆ‘ä»¬åªæ˜¯ä»‹ç»äº†APIç»„å®¢æˆ·ç«¯ç±»å‹çš„ç»“æ„ä½“ï¼Œå¹¶æ²¡æœ‰æåŠå®ƒçš„æ–¹æ³•ã€‚
æˆ‘ä»¬è¿˜æ˜¯ä»¥<code>appsv1.AppsV1Client</code>ç»„å®¢æˆ·ç«¯ä¸ºä¾‹ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">k8s.io/client-go/kubernetes/typed/apps/v1/apps_client.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> AppsV1Client </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restClient rest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppsV1Client</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">DaemonSets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">namespace </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> DaemonSetInterface </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">newDaemonSets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> namespace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppsV1Client</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Deployments</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">namespace </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> DeploymentInterface </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">newDeployments</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> namespace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppsV1Client</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ReplicaSets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">namespace </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ReplicaSetInterface </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">newReplicaSets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> namespace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å®ƒæ‰€å°è£…çš„æ–¹æ³•ä»¥ç»„å†…çš„å„èµ„æºç±»å‹ä¸ºæ–¹æ³•åï¼Œä»¥å‘½åç©ºé—´ä¸ºå‚æ•°ï¼Œå¹¶è¿”å›å„èµ„æºå®¢æˆ·ç«¯ã€‚</p><p><code>Clientset</code>ï¼ŒAPIç»„å®¢æˆ·ç«¯ï¼Œèµ„æºå®¢æˆ·ç«¯ï¼Œ<code>RESTClient</code>çš„å…³ç³»å¯ä»¥è¢«æ€»ç»“æˆä¸‹å›¾æ‰€ç¤ºï¼š</p><img loading="lazy" src="/crd-controller-from-scratch/assets/images/client-relation-02d2d84324296d93114ff42bcbae2b9c.png" width="380px" class="img_ev3q"><p>å…¶å®ï¼Œ<code>clientset</code>çš„é“¾å¼è°ƒç”¨æœ¬è´¨ä¸Šå°±æ˜¯å°è£…çš„ä¸åŒå®¢æˆ·ç«¯ä¹‹é—´çš„è½¬åŒ–ï¼Œæœ€ç»ˆç”±<code>RESTClient</code>ç±»å‹å®Œæˆä¸Kubernetes APIçš„äº¤äº’ã€‚
ä¾‹å¦‚å¯¹äºå¦‚ä¸‹<code>clientset</code>çš„é“¾å¼è°ƒç”¨ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">clientset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AppsV1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Deployments</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;default&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TODO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GetOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å®¢æˆ·ç«¯ç±»å‹çš„è½¬åŒ–å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img loading="lazy" src="/crd-controller-from-scratch/assets/images/client-chain-005eb2caaea2b33a2f5ce9b7a4aee4e6.png" width="680px" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="å°ç»“">å°ç»“<a href="#å°ç»“" class="hash-link" aria-label="Direct link to å°ç»“" title="Direct link to å°ç»“">â€‹</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>è™½ç„¶åœ¨æœ¬èŠ‚ä¸­æˆ‘ä»¬ä»‹ç»äº†<code>client-go</code>ä¸­çš„å¤šä¸ªå®¢æˆ·ç«¯ç±»å‹ï¼Œä½†æ˜¯æœ¬èŠ‚çš„é‡ç‚¹ä¾ç„¶æ˜¯<code>RESTClient</code>çš„ä½¿ç”¨æ–¹æ³•ã€‚
åŸå› æ˜¯ä¸ç®¡æ˜¯<code>Clientset</code>è¿˜æ˜¯<em>APIç»„å®¢æˆ·ç«¯</em>ï¼Œäº¦æˆ–æ˜¯<em>èµ„æºå®¢æˆ·ç«¯</em>ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸ºKubernetes<strong>åŸç”Ÿ</strong>èµ„æºå°è£…çš„å®¢æˆ·ç«¯ã€‚
å¯¹äºè‡ªå®šä¹‰èµ„æºï¼Œæˆ‘ä»¬ä¸å¾—ä¸åˆ©ç”¨æ›´ä¸ºåº•å±‚çš„<code>RESTClient</code>æ¥ç¼–å†™å®¢æˆ·ç«¯ã€‚</p></div></div><div class="footnotes"><hr><ol><li id="fn-1"><p>ä¸ºäº†å™è¿°ä¸Šçš„æ–¹ä¾¿ï¼Œåœ¨æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šæŠŠ<em>APIç»„åŠå…¶ç‰ˆæœ¬</em>ç®€ç§°ä¸ºAPIç»„ï¼Œ<em>GV</em>æˆ–è€…<em>GroupVersion</em>ã€‚<a href="#fnref-1" class="footnote-backref">â†©</a></p></li><li id="fn-2"><p><code>rest</code>æŒ‡<code>client-go</code>åº“ä¸­çš„<code>rest</code>åŒ…ã€‚<a href="#fnref-2" class="footnote-backref">â†©</a></p></li><li id="fn-3"><p>ä¾‹å­ä¸­ç»™çš„æ˜¯è¿è¡Œåœ¨Kubernetesé›†ç¾¤å¤–çš„å®¢æˆ·ç«¯ä¾‹å­ï¼Œå¯¹äºå·²çŸ¥è¦è¿è¡Œåœ¨é›†ç¾¤ä¸­çš„å®¢æˆ·ç«¯ï¼Œéœ€è¦ä½¿ç”¨<code>rest.InClusterConfig()</code>æ–¹æ³•æ¥åˆ›å»º<code>rest.Config</code>å¯¹è±¡ã€‚</p><img loading="lazy" src="/crd-controller-from-scratch/assets/images/config-inside-2cdf59445f5ce7dfcc8a8b134b335b2d.png" style="width:90%" class="img_ev3q"><p><a href="#fnref-3" class="footnote-backref">â†©</a></p></li></ol></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/crd-controller-from-scratch/docs/client-go/client-go"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/crd-controller-from-scratch/docs/client-go/controller"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Controller</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#clientsetä¸restclient" class="table-of-contents__link toc-highlight">Clientsetä¸RESTClient</a></li><li><a href="#restclientåŸºæœ¬ç”¨æ³•" class="table-of-contents__link toc-highlight">RESTClientåŸºæœ¬ç”¨æ³•ğŸˆ</a><ul><li><a href="#requestç±»å‹" class="table-of-contents__link toc-highlight">Requestç±»å‹</a></li></ul></li><li><a href="#èµ„æºå®¢æˆ·ç«¯" class="table-of-contents__link toc-highlight">èµ„æºå®¢æˆ·ç«¯</a></li><li><a href="#client-goä¸­å„å®¢æˆ·ç«¯ç±»å‹ä¹‹é—´çš„å…³ç³»" class="table-of-contents__link toc-highlight">client-goä¸­å„å®¢æˆ·ç«¯ç±»å‹ä¹‹é—´çš„å…³ç³»</a></li><li><a href="#å°ç»“" class="table-of-contents__link toc-highlight">å°ç»“</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Xudong Wang, Under license <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a>, Built with Docusaurus.ğŸˆ</div></div></div></footer></div>
<script src="/crd-controller-from-scratch/assets/js/runtime~main.56e28771.js"></script>
<script src="/crd-controller-from-scratch/assets/js/main.66bc2718.js"></script>
</body>
</html>